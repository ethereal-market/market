{"version":3,"file":"bundle.js","sources":["../node_modules/@playframe/oversync/index.js","../node_modules/@playframe/statue/index.js","../node_modules/@playframe/h/index.js","../node_modules/@playframe/shadom/index.js","../node_modules/@playframe/router/index.js","../node_modules/@playframe/playframe/index.js","../src/components/Forms.coffee","../src/config.coffee","../src/util.coffee","../src/View.coffee","../src/data/web3.coffee","../src/components/NavBar.coffee","../src/components/Intro.coffee","../src/components/Tokens.coffee","../src/components/Book.coffee","../src/components/History.coffee","../src/data/Market.coffee","../src/data/TokenPair.coffee","../src/data/WETH9.abi.coffee","../src/state/market.coffee","../src/state/token.coffee","../src/app.coffee","../src/state/rainbow.coffee","../src/state/form.coffee","../src/state/account.coffee"],"sourcesContent":["// Generated by CoffeeScript 2.3.2\n// ![PlayFrame](https://avatars3.githubusercontent.com/u/47147479)\n// # OverSync\n\n// ###### 0.4 kB Frame Rendering Engine\n\n// ## Installation\n// ```sh\n// npm install --save @playframe/oversync\n// ```\n\n// ## Functionality Overview\n// ```js\n// import oversync from '@playframe/oversync'\n\n// const sync = oversync(Date.now, requestAnimationFrame)\n// ```\n\n// Each method schedules given function\n// to be executed in specific time and order\n\n// ```js\n// sync.next(fn) // events handling and dom read\n// sync.catch(fn) // error handling\n// sync.then(fn) // data work is done here\n// sync.finally(fn) // finilizing data\n// sync.render(fn) // dom manipulation\n\n// // Actual requestAnimationFrame callback\n// // No work should be done here\n// sync.frame(fn)\n// ```\n\n// #### Execution strategy\n// Render a frame_0 first,\n// then request a new frame_1 and immediately do work.\n// After work is done VM is idling for up to 10ms\n// until frame callback is fired and frame_1 finally rendered.\n// Any event occuring after work is done\n// but before frame_1 is rendered will schedule actual work\n// to be done onlly after frame_1 is rendered\n\n// ```\n// 1ms Request frame_0 and setTimeout(work_for_frame_1)\n// 2ms frame_0 is rendered by browser\n// 3ms Request frame_1\n// 4ms work_for_frame_1: read dom, do work, write dom\n// ... idle\n// 8ms Click: sync.next(click_handler) for frame_2\n// ... idle\n// 10ms Fetch: sync.then(fetch_handler) for frame_2\n// ...idle\n// 15ms Animation callback: setTimeout(work_for_frame_2)\n// 16ms frame_1 is rendered\n// 17ms Request frame_2\n// 18ms work_for_frame_2: read dom, do work, write dom\n// ...\n// ```\n\n// ## Annotated Source\n// Let's define a higher order function\n// that would take a `now` timestamp function,\n// scheduling `next` function and optionally\n// a list `steps` of desired execution order and method names\n// and an optional `step` method name.\nvar delta, pusher, runner, scheduler;\n\nmodule.exports = (now, next, steps = ['next', 'catch', 'then', 'finally', 'render'], step = 'frame') => {\n  var delta_runner, push_and_run, schedule, step_ops, steps_ops, sync;\n  // For each step we would prepare and empty array\n  step_ops = [];\n  steps_ops = steps.map(() => {\n    return [];\n  });\n  // For measuring time deltas we would have a fancy runner function\n  delta_runner = delta(now)(runner);\n  // `schedule` function for requesting next frame\n  // in which we would run our `frame` operations and\n  // schedule work for the rest of the steps\n  schedule = scheduler(next)(() => {\n    var run;\n    run = delta_runner();\n    run(step_ops);\n    return setTimeout(() => {\n      return steps_ops.forEach(run);\n    });\n  });\n  // A pusher function that will `schedule` on every push\n  push_and_run = pusher(schedule);\n  // Dynamically creating methods that would push operations\n  // and schedule execution and returning `sync`\n  sync = {};\n  sync[step] = push_and_run(step_ops);\n  steps.forEach((step, i) => {\n    return sync[step] = push_and_run(steps_ops[i]);\n  });\n  return sync;\n};\n\n// #### Abstract functions\n\n// Our `scheduler` is creating a throttled `schedule`\nscheduler = (next) => {\n  return (f) => {\n    var _scheduled, g;\n    _scheduled = false;\n    g = (x) => {\n      _scheduled = false;\n      return f(x);\n    };\n    return () => {\n      if (!_scheduled) {\n        _scheduled = true;\n        next(g);\n      }\n    };\n  };\n};\n\n// This `pusher` is creating a function that will run `task`\n// before pushing `op` to `ops`\npusher = (task) => {\n  return (ops) => {\n    return (op) => {\n      task();\n      ops.push(op);\n    };\n  };\n};\n\n// Feeding timestamps produced by `now` to a given `f`\n// like our `runner`\ndelta = (now) => {\n  return (f) => {\n    var _prev_ts;\n    _prev_ts = now();\n    return () => {\n      var ts;\n      return f({\n        delta: (ts = now()) - _prev_ts,\n        ts: (_prev_ts = ts)\n      });\n    };\n  };\n};\n\n// This runner will feed `x` to a list of given `ops`.\n// It will recover if any operation fails.\n// Clearing `ops` list at the end\nrunner = (x) => {\n  return (ops) => {\n    var e, i, length, recover;\n    i = 0;\n    // Rechecking length in outer loop\n    // could push more ops while running\n    while (i < (length = ops.length)) {\n      try {\n        while (i < length) {\n          ops[i++](x);\n        }\n      } catch (error) {\n        e = error;\n        console.error(e);\n        if (recover = ops[i - 1].r) { // recovering\n          recover(e);\n        }\n      }\n    }\n    ops.length = 0; // mutating ðŸ‘¹\n  };\n};\n","// Generated by CoffeeScript 2.3.2\n  // ![PlayFrame](https://avatars3.githubusercontent.com/u/47147479)\n  // # Statue\n\n  // ###### 0.4 kb Art of functional State\n\n  // ## Installation\n  // ```sh\n  // npm install --save @playframe/statue\n  // ```\n\n  // ## Description\n  // Statue is a [Redux](https://github.com/reduxjs/redux)\n  // like functional state manegement library that lets you define\n  // and access actions right inside of your state. So you could\n  // describe a deeply nested state tree with nested actions\n  // in one simple object.\n\n  // To update state, action could return a new object\n  // that has one or more properties.\n  // This will produce a new state with those properties updated.\n\n  // Another option is to mutate a state object passed to your function.\n  // Mutation will be detected and this will produce a new state as well.\n  // Returned value is ignored in this case.\n  // If you are writing a performance demanding reducer,\n  // please use this mutation trick and define the hottest property as\n  // the first one in your initial state for faster checking.\n\n  // If you don't want to update state, please make sure you action\n  // returns something\n  // [falsy](https://developer.mozilla.org/en-US/docs/Glossary/Falsy)\n  // or the same state that was passed to it\n\n  // To work with state directly you can do\n  // ```js\n  // // to update the state\n  // state._(updated)\n\n  // // to read the latest state\n  // state = state._()\n\n  // // to turn a function into a reducer\n  // state._.new_action = state._( (x, state)=> state.x = x )\n  // ```\n  //  Statue also cares not to send too many updates\n  // from child to parent branches\n  // ## Usage\n  // ```js\n  // import statue from '@playframe/statue'\n  // const state = statue({\n  //   i: 0,\n  //   _: {\n  //     increment: (x, state)=> i: state.i + 1,\n  //     incrementBy: (n)=>(event, state)=> state.i += n // mutating\n  //   },\n  //   subState: {\n  //     i: 0,\n  //     _: {\n  //       increment: (x, state)=> i: state.i + 1\n  //     }\n  //   }\n  //   },\n  //   setTimeout,\n  //   (newState)=> {\n  //     console.log('Counter is:', newState.i)\n  //     console.log('Subcounter is:', newState.subState.i)\n  //   }\n  // )\n  // for(let j = 0; j < 100; j++){\n  //   state.subState._.increment()\n  //   state.subState._.increment()\n  //   state._.increment()\n  // }\n  // // Logs only once\n  // //> Counter is: 100\n  // //> Subcounter is: 200\n  // // Will increment by 10 and log in console on every click\n  // $('button').click( state._.incrementBy(10) )\n  // ```\n  // ## Annotated Source\n  // Caching static functions from `Object`\nvar assign, create, is_function, keys, statue,\n  hasProp = {}.hasOwnProperty;\n\n({assign, create, keys} = Object);\n\nis_function = (f) => {\n  return typeof f === 'function';\n};\n\n// Let's define a function that takes a takes `state_actions`\n// as an initial state and its reducers (actions)\n// defined under `_` (underscore) property.\n// Our function also takes `level_up` or 'subscribe' function\n// that will be called when state updates. Most sertainly we don't\n// want to update the whole state tree every time nested leaf updates,\n// so we also pass a `delayed` function that will help debounce\n// parent update\nmodule.exports = statue = (state_actions, delayed, level_up) => {\n  /*                       state._.actions\n                                 ]_[.state._.actions\n                                 [_]      ]_[.\n                                 [_]      [_]\n  */\n  var _nested, _scheduled, _state, action, actions, delay_nested, inject_state, k, reset, save_state, schedule, update_parent, update_state, v;\n  actions = state_actions._;\n  _state = state_actions; // _closure\n  _scheduled = false; // _closure\n  _nested = reset = () => {\n    return _nested = reset; // reset _nested\n  };\n  \n  // delaying child state updates\n  delay_nested = (f) => {\n    _nested = ((_nested) => {\n      return () => {\n        _nested();\n        f();\n      };\n    })(_nested);\n    schedule();\n  };\n// recursive statue if there nested actions\n  for (k in state_actions) {\n    v = state_actions[k];\n    if (v && v._) {\n      _state[k] = statue(v, delay_nested, ((k) => {\n        return (sub_state) => { // closure for k\n          return _state[k] = sub_state; // executes as _nested\n        };\n      })(k));\n    }\n  }\n  \n  // saving new state in closure\n  save_state = (state) => {\n    schedule();\n    return _state = state;\n  };\n  schedule = () => {\n    if (!_scheduled) {\n      _scheduled = true;\n      // lazy parent update\n      delayed(update_parent);\n    }\n  };\n  update_parent = () => {\n    var proto_state;\n    _scheduled = false;\n    proto_state = _state;\n    _state = create(null);\n    for (k in proto_state) {\n      // merging prototype chain state\n      _state[k] = proto_state[k];\n    }\n    _nested();\n    level_up(_state);\n  };\n  // This function is a little overloaded, it's a getter/setter but\n  // also is a function wrapper.\n  // You can access it like this `yourState._(updated)`.\n  // The wrapper will return a twin of your function\n  // that calls yours and passes a copy of latest state\n  // as the second argument. State will update, if the copy is mutated\n  // or a new object returned. If your function\n  // returns a new function, it will be wrapped in the same manner.\n  // So we support state updates for deeply curried functions.\n\n  // curry down or make state\n  _state._ = update_state = (arg) => {\n    if (is_function(arg)) {\n      return inject_state(arg);\n    } else {\n      if (arg) {\n        return save_state(assign(create(_state), arg));\n      } else {\n        return _state;\n      }\n    }\n  };\n  // `inject_state` is a higher order function that does the magic.\n  // It produces a cheap clone if current state by setting current\n  // state as its prototype. Please note that such a clone has no\n  // own properties, and all property accees falls back to its\n  // prototype. If we mutate such a clone, new properties are\n  // easily detected\n  inject_state = (f) => {\n    return (x) => {\n      var cloned, mutated, y;\n      // _state as prototype of cloned\n      cloned = create(_state);\n      y = f(x, cloned);\n      for (k in cloned) {\n        if (!hasProp.call(cloned, k)) continue;\n        // mutation detected\n        mutated = true;\n        save_state(cloned);\n        break;\n      }\n      if (is_function(y)) {\n        // recursevely currying down\n        return inject_state(y);\n      } else {\n        if (y && !mutated && y !== cloned && !y.then) { // not promise\n          save_state(assign(cloned, y));\n        }\n        return y;\n      }\n    };\n  };\n// Now let's wrap all of your actions and set under the `_` property.\n// That's it! You new state machine is ready!\n\n// bind actions to state\n  for (k in actions) {\n    action = actions[k];\n    update_state[k] = inject_state(action);\n  }\n  return _state;\n};\n","// Generated by CoffeeScript 2.3.2\n// ![PlayFrame](https://avatars3.githubusercontent.com/u/47147479)\n// # h\n\n// ###### 0.3 kB Virtual Dom Producer\n\n// ## Installation\n// ```sh\n// npm install --save @playframe/h\n// ```\n\n// ## Usage\n// ```js\n// import h from '@playframe/h'\n\n// // directly\n// h('a', {href: 'https://github.com/playframe/h'}, 'PlayFrame/h')\n\n// // JSX\n// const link = ()=>\n//   <a href=\"https://github.com/playframe/h\"> PlayFrame/h </a>\n// ```\n\n// ## Annotated Source\n\n// Creating a unique Symbol for distinction between Virtual Nodes\n// and plain Arrays\nvar VNODE, _registry, h, invoke;\n\nVNODE = Symbol('VNODE');\n\n_registry = {};\n\n// Our Virtual Node is produced from a list of arguments passed\n// to `h` function. Children are passed as tail of arguments,\n// but any of them could be wrapped in Array\n\n// ```js\n// h('div', {class: 's'}, child1, [ child2, child3 ], child4)`)\n// ```\n// To achieve no runtime overhead we will avoid creating a new object\n// for Virtual Node and new Array for children. We will just mark array\n// of passed arguments as a `VNODE` and return it as is.\n// This is compensated by a more advenced child walker used in\n// [@playframe/dom](https://github.com/playframe/dom)\nmodule.exports = h = (...a) => {\n  var component, name;\n  if (typeof (name = a[0]) === 'function') {\n    return invoke(...a);\n  } else if (component = _registry[name]) {\n    a[0] = component;\n    return invoke(...a);\n  } else {\n    a[VNODE] = true;\n    return a;\n  }\n};\n\nh.VNODE = VNODE;\n\n// Registering custom components like\n// `h.use({'my-component': MyComponent})`\nh.use = (components) => {\n  var k, v;\n  for (k in components) {\n    v = components[k];\n    _registry[k] = v;\n  }\n};\n\n// If the first argument of `h` function is a not a `'div'` but\n// your Component function, we will flatten the children and attach\n// them to `props`\ninvoke = (Component, props, ...children) => {\n  var child, flat, i, len;\n  if (children[0]) {\n    flat = props.children = [];\n    for (i = 0, len = children.length; i < len; i++) {\n      child = children[i];\n      if (!child[VNODE] && Array.isArray(child)) {\n        flat.push(...child);\n      } else {\n        flat.push(child);\n      }\n    }\n  }\n  return Component(props);\n};\n","// Generated by CoffeeScript 2.4.1\n// ![PlayFrame](https://avatars3.githubusercontent.com/u/47147479)\n// # ShaDOM\n\n// ###### 1.5 kB DOM + Shadow DOM Manipulation\n\n// ## Installation\n// ```sh\n// npm install --save @playframe/shadom\n// ```\n\n// ## Usage\n// ```js\n// import oversync from '@playframe/oversync'\n// import h from '@playframe/h'\n// import shadom from '@playframe/shadom'\n\n// const sync = oversync(Date.now, requestAnimationFrame)\n\n// const state = {}\n// const View = (state)=> <div></div> // h('div')\n\n// const render = shadom(sync)(document.body)\n\n// // to update DOM we do\n// render(View, state)\n// ```\n\n// ## Annotated Source\n\n// `@playframe/h` is required as peer dependency. We are importing\n// a `VNODE`\n// [Symbol](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Symbol)\n// constant. Symbol can't be created twice in two different places.\n// It is important to use the same instance of `@playframe/h` acroass\n// your app\nvar ATTR, ELEMENT, EVENTS, FIRST_CHILD, KEYED, NAME, VNODE, _first_run, _sync, doc, emmit_remove, eventHandler, get_key, h, isArray, make_el, mutate_children, mutate_dom, patcher, remove_el, scan, set, set_attr;\n\n({VNODE} = h = require('@playframe/h'));\n\n({isArray} = Array);\n\ndoc = document;\n\n// Let's remind outselves our virtual dom data structure\n// `['div', {class: 's'}, children...]` to clarify the constants.\nNAME = 0;\n\nATTR = 1;\n\nFIRST_CHILD = 2;\n\n// Symbols are designed to assign metaproperties to existing\n// objects. Those properties are not occuring in `for` or `Object.keys`\n// iteration. They are also free from name conflicts. For example\n// different libraries can create own `Symbol('ELEMENT')` and use them\n// on the same object without any collision\nELEMENT = Symbol('ELEMENT');\n\nEVENTS = Symbol('EVENTS');\n\nKEYED = Symbol('KEYED');\n\n_sync = null;\n\n_first_run = true;\n\n// This function will handle event dispatching\neventHandler = (event) => {\n  event.currentTarget[EVENTS][event.type](event);\n};\n\n// We are exporting a higher order function that will take `sync` scheduler\n// and a `root` element. It will return a function that takes latest\n// `view` function and `state` and schedules vDOM producing and\n// DOM mutating\nmodule.exports = (sync) => {\n  return (root) => {\n    var _dom, _new_v_dom, _v_dom, render;\n    _sync = sync;\n    _v_dom = null;\n    _new_v_dom = null;\n    if (_dom = root.children[0]) {\n      _v_dom = scan(_dom);\n    }\n    render = () => {\n      _dom = mutate_dom(root, _dom, _new_v_dom, _v_dom);\n      _v_dom = _new_v_dom;\n    };\n    return (view, state) => {\n      _new_v_dom = view(state);\n      if (_first_run) { // render asap\n        render();\n        _first_run = false;\n      } else {\n        _sync.render(render);\n      }\n    };\n  };\n};\n\n// Reusing preexisting html nodes in `root` element. This will benefit\n// apps with server side pre-rendering\nscan = (el, NS) => {\n  var childNodes, i, m, ref, shadow, v_dom;\n  NS = el.namespaceURI || NS;\n  if (el.nodeType === 3) { // text\n    return el.nodeValue;\n  } else {\n    v_dom = h(el.nodeName.toLowerCase(), null);\n    ({childNodes} = (shadow = el.shadowRoot) ? (v_dom.patch = patcher(v_dom, el, shadow, NS), shadow) : el);\n    for (i = m = 0, ref = childNodes.length; m < ref; i = m += 1) {\n      v_dom.push(scan(childNodes[i]));\n    }\n    return v_dom;\n  }\n};\n\n// This function will take a DOM element `el` and its `parent` element.\n// Also it takes a new vDOM `vnode` and `old_vnode`. Their diff will\n// mutate `el`. `NS` is a XMLNS namespace for working with SVG or XHTML\nmutate_dom = (parent, el, vnode, old_vnode, NS) => {\n  var new_el, onupdate, patch, ref;\n  // console.log 'mutate_dom', vnode, old_vnode\n  if (vnode !== old_vnode) {\n    if ((old_vnode != null) && (vnode != null) && !old_vnode[VNODE] && !vnode[VNODE]) {\n      el.nodeValue = vnode; // text node\n    } else {\n      // for SVG or XHTML\n      NS = vnode && ((ref = vnode[ATTR]) != null ? ref.xmlns : void 0) || NS;\n      if ((vnode == null) || (old_vnode == null) || old_vnode[NAME] !== vnode[NAME]) {\n        // replace node\n        if (vnode != null) {\n          new_el = make_el(vnode, NS);\n          parent.insertBefore(new_el, el);\n        }\n        if (old_vnode != null) {\n          remove_el(parent, el);\n          _sync.next(() => {\n            return emmit_remove(old_vnode);\n          });\n        }\n        return new_el; // update node\n      } else {\n        if (patch = old_vnode.patch) {\n          vnode.patch = patch;\n          patch(vnode);\n        } else {\n          set_attr(el, vnode[ATTR], old_vnode[ATTR], NS);\n          mutate_children(el, vnode, old_vnode, NS);\n        }\n        if (onupdate = vnode[ATTR] && vnode[ATTR][_first_run ? 'oncreate' : 'onupdate']) {\n          onupdate(el);\n        }\n      }\n    }\n  }\n  return el;\n};\n\n// This function will compare and mutate children of given `el`.\n// Keyed updates are supported\nmutate_children = (el, vnode, old_vnode, NS) => {\n  var by_key, child, child_el, el_i, i, j, k, key, keyed, l, ll, old_child, old_key, old_keyed, replaced_el, replacement, sub_child, sub_i, sub_il, sub_j, sub_jl, v;\n  i = j = FIRST_CHILD;\n  sub_i = sub_j = sub_il = sub_jl = el_i = 0;\n  l = vnode.length;\n  ll = (old_vnode != null ? old_vnode.length : void 0) || 0;\n  by_key = false;\n  while (true) {\n    // 2 inline child walkers for performance reasons\n    // getting next child in ['div', {}, child, [child, child],...]\n    while (i <= l) {\n      child = vnode[i];\n      if ((child == null) || (child === true || child === false)) {\n        i++; // continue\n      } else if (child[VNODE] || !isArray(child)) {\n        i++;\n        break;\n      } else {\n        sub_il || (sub_il = child.length);\n        if (((sub_child = child[sub_i]) != null) && (sub_child !== true && sub_child !== false)) {\n          sub_i++;\n          child = sub_child;\n          break;\n        } else {\n          if (sub_i < sub_il) {\n            sub_i++;\n          } else {\n            sub_i = sub_il = 0;\n            i++;\n          }\n        }\n      }\n    }\n    key = get_key(child);\n    while (j <= ll) {\n      old_key = null;\n      old_child = old_vnode[j];\n      if ((old_child == null) || (old_child === true || old_child === false)) {\n        j++; // continue\n      } else if (old_child[VNODE] || !isArray(old_child)) {\n        j++;\n        old_key = get_key(old_child);\n        if (!(old_keyed && old_key && !old_keyed[old_key])) {\n          break;\n        }\n      } else {\n        sub_jl || (sub_jl = old_child.length);\n        if (((sub_child = old_child[sub_j]) != null) && (sub_child !== true && sub_child !== false)) {\n          sub_j++;\n          old_child = sub_child;\n          old_key = get_key(old_child);\n          if (!(old_keyed && old_key && !old_keyed[old_key])) {\n            break;\n          }\n        } else {\n          if (sub_j < sub_jl) {\n            sub_j++;\n          } else {\n            sub_j = sub_jl = 0;\n            j++;\n          }\n        }\n      }\n    }\n    if (!((child != null) || (old_child != null))) {\n      break;\n    }\n    child_el = el.childNodes[el_i];\n    if (!by_key && (key || old_key)) {\n      by_key = true; // switch to keyed mode\n      old_keyed = old_vnode && old_vnode[KEYED];\n      keyed = vnode[KEYED] = Object.create(null);\n    }\n    if (!(old_keyed && child && old_key !== key)) {\n      // direct mutation unless key mismatch\n      child_el = mutate_dom(el, child_el, child, old_child, NS);\n    } else {\n      // if there is key mismatch\n      // we will replace current dom node\n      // with an existing keyed or a new one\n      if (replacement = old_keyed[key]) {\n        replaced_el = mutate_dom(el, replacement[ELEMENT], child, replacement, NS);\n      } else {\n        replaced_el = make_el(child, NS);\n      }\n      el.insertBefore(replaced_el, child_el);\n      if (old_child) {\n        remove_el(el, child_el);\n        if (old_key) {\n          // emit remove if not reused\n          _sync.render(((old_key) => {\n            return () => { // old_key closure\n              if (old_keyed[old_key]) {\n                return emmit_remove(old_keyed[old_key]);\n              }\n            };\n          })(old_key));\n        } else {\n          emmit_remove(old_child);\n        }\n      }\n      child_el = replaced_el;\n    }\n    if (child != null) {\n      el_i++; // moving pointer to next DOM element\n      if (key) {\n        child[ELEMENT] = child_el;\n        keyed[key] = child;\n        old_keyed && (old_keyed[key] = null);\n      }\n    }\n  }\n  // end of loop\n  if (old_keyed) {\n// copying over unused cached keyed nodes\n    for (k in old_keyed) {\n      v = old_keyed[k];\n      if (v) {\n        keyed[k] = v;\n      }\n    }\n  }\n};\n\n// This function will create a new DOM element with its children\nmake_el = (vnode, NS) => {\n  var el, oncreate, shadow, shadow_props;\n  if (vnode[VNODE]) {\n    el = NS ? doc.createElementNS(NS, vnode[NAME]) : doc.createElement(vnode[NAME]);\n    set_attr(el, vnode[ATTR], null, NS);\n    if (shadow_props = vnode[ATTR] && vnode[ATTR].attachShadow) {\n      shadow = el.attachShadow(shadow_props);\n      vnode.patch = patcher(vnode, el, shadow, NS);\n      mutate_children(shadow, vnode, null, NS);\n    } else {\n      mutate_children(el, vnode, null, NS);\n    }\n    if (oncreate = vnode[ATTR] && vnode[ATTR].oncreate) {\n      oncreate(el);\n    }\n    return el;\n  } else {\n    return doc.createTextNode(vnode);\n  }\n};\n\n// Removing element from its parent\nremove_el = (parent, el) => {\n  parent.removeChild(el);\n};\n\nemmit_remove = (vnode) => {\n  var child, length, onremove;\n  ({length} = vnode);\n  while (length-- > 0) {\n    if (isArray(child = vnode[length])) {\n      emmit_remove(child);\n    }\n  }\n  if (onremove = vnode[ATTR] && vnode[ATTR].onremove) {\n    onremove();\n  }\n};\n\n// Comparing and setting attributes\nset_attr = (el, attr, old_attr, NS) => {\n  var k, old_v, v;\n  for (k in old_attr) {\n    old_v = old_attr[k];\n    if (!(attr && (attr[k] != null))) {\n      set(el, k, null, old_v, NS);\n    }\n  }\n  for (k in attr) {\n    v = attr[k];\n    old_v = k === 'value' || k === 'checked' ? el[k] : old_attr && old_attr[k];\n    if (v !== old_v) {\n      set(el, k, v, old_v, NS);\n    }\n  }\n};\n\nset = (el, name, value, old_value, NS) => {\n  var events, k, style, v;\n  if (name === 'key' || name === 'attachShadow') {\n\n  // skip\n  } else if (name === 'style') {\n    style = el[name];\n    if (typeof value === 'string') {\n      style.cssText = value;\n    } else {\n      if (typeof old_value === 'string') {\n        style.cssText = '';\n      } else {\n        value = {...value};\n        for (k in old_value) {\n          if (value[k] == null) {\n            value[k] = '';\n          }\n        }\n      }\n      for (k in value) {\n        v = value[k];\n        if (k.charCodeAt(0) === 45) { // starts with '-'\n          style.setProperty(k, v);\n        } else {\n          style[k] = v;\n        }\n      }\n    }\n  } else {\n    // starts with 'on', event listener\n    if (name.charCodeAt(0) === 111 && name.charCodeAt(1) === 110) {\n      name = name.slice(2);\n      events = el[EVENTS] || (el[EVENTS] = {});\n      old_value || (old_value = events[name]);\n      events[name] = value;\n      if (value) {\n        if (!old_value) {\n          el.addEventListener(name, eventHandler);\n        }\n      } else {\n        el.removeEventListener(name, eventHandler);\n      }\n    // attribute\n    } else if (name in el && (name !== 'list' && name !== 'type' && name !== 'draggable' && name !== 'spellcheck' && name !== 'translate') && !NS) {\n      el[name] = value != null ? value : value = '';\n    } else if ((value != null) && value !== false) {\n      el.setAttribute(name, value);\n    } else {\n      el.removeAttribute(name);\n    }\n  }\n};\n\n// Getting a key from a virtual node\nget_key = (vnode) => {\n  return vnode && vnode[ATTR] && vnode[ATTR].key;\n};\n\n// Creating a shadow DOM `patch` function \npatcher = (_old_vnode, el, shadow, NS) => {\n  return (vnode) => {\n    if (vnode !== _old_vnode) {\n      set_attr(el, vnode[ATTR], _old_vnode[ATTR], NS);\n      mutate_children(shadow, vnode, _old_vnode, NS);\n      _old_vnode = vnode;\n    }\n  };\n};\n","// Generated by CoffeeScript 2.3.2\n// ![PlayFrame](https://avatars3.githubusercontent.com/u/47147479)\n// # Router\n\n// ###### 1kB Trie Router for PlayFrame\n\n// ## Installation\n// ```sh\n// npm install --save @playframe/router\n// ```\n\n// ## Usage\n// ```js\n// import {h, app, route, mount, Component} from '@playframe/playframe'\n\n// route({\n//   counter: 1,\n//   _: {\n//     inc: (e, state)=> state.counter++,\n//     dec: (e, state)=> state.counter--\n//   },\n//   routes: {\n//     '/': ({state})=> <a href=\"/hello/world\"><h1>Link</h1></a>,\n//     '/counter': ({state})=> CounterView(state),\n//     '/hello/:name': ({state, param})=> <h1>Hello {param.name}!</h1>,\n//     '/*': ()=>  <h1>404</h1>\n//   }\n// })(\n//   mount(document.body)\n// )\n// ```\n\n// ## Source\nvar LEAF, NAMED, WILDCARD, _404, _Page, _fallback, _href, _props, _state, _subscribed, _sync, add_methods, doc, forest, get_trie, grow_trie, isArray, make_trie, match, set_Page, subscribe, view, walk_trie;\n\ndoc = this.document;\n\n({isArray} = Array);\n\nNAMED = Symbol('NAMED');\n\nWILDCARD = Symbol('WILD');\n\nLEAF = Symbol('LEAF');\n\nforest = new WeakMap;\n\n_sync = null;\n\n_state = null;\n\n_href = null;\n\n_props = null;\n\n_Page = null;\n\n_subscribed = false;\n\n_404 = () => {\n  return 404;\n};\n\n_fallback = () => {\n  return _Page = _404;\n};\n\nmodule.exports = view = (sync) => {\n  _sync = sync;\n  return (state, l) => {\n    var href;\n    _state = state;\n    ({href} = l || (l = location));\n    if (!_subscribed && doc) {\n      subscribe();\n      _subscribed = true;\n    }\n    if (href !== _href) {\n      set_Page(l);\n    }\n    if (!state._.push) {\n      add_methods();\n    }\n    _props.state = state;\n    return _Page(_props);\n  };\n};\n\nadd_methods = () => {\n  var hop;\n  hop = () => {\n    return _sync.next(() => {\n      set_Page(location);\n      _state._({});\n      _sync.frame(() => {\n        return scrollTo(0, 0);\n      });\n    });\n  };\n  _state._.push = (href) => {\n    history.replaceState({\n      height: document.body.clientHeight\n    }, '');\n    history.pushState({}, '', href);\n    hop();\n  };\n  _state._.replace = (href) => {\n    history.replaceState({}, '', href);\n    hop();\n  };\n};\n\nsubscribe = () => {\n  doc.addEventListener(doc.ontouchstart ? 'touchstart' : 'click', (event) => {\n    var el;\n    el = (typeof event.composedPath === \"function\" ? event.composedPath()[0] : void 0) || event.target;\n    while (el && el.nodeName !== 'A') {\n      el = el.parentNode;\n    }\n    if (!el || event.button !== 0 || event.metaKey || event.altKey || event.ctrlKey || event.shiftKey || el.target === '_blank' || el.origin !== location.origin || el.getAttribute('href').startsWith('#')) {\n      return;\n    }\n    event.preventDefault();\n    return _state._.push(el.href);\n  });\n  addEventListener('popstate', ({state}) => {\n    var style;\n    ({style} = doc.body);\n    style.minHeight = `${(state != null ? state.height : void 0)}px`;\n    set_Page(location);\n    _state._({});\n    return setTimeout((() => {\n      return _sync.render(() => {\n        return style.minHeight = '';\n      });\n    }), 1000);\n  });\n};\n\nset_Page = (l) => {\n  var hash, href, i, j, k, len, pair, pathname, query, ref, search, v;\n  ({href, pathname, search, hash, query} = l);\n  _href = href;\n  if (!query) {\n    query = {};\n    ref = search.slice(1).split('&');\n    for (i = j = 0, len = ref.length; j < len; i = ++j) {\n      pair = ref[i];\n      [k, v] = pair.split('=');\n      query[k] = v;\n    }\n  }\n  match(get_trie(_state.routes), pathname);\n  _props = {..._props, pathname, search, query, hash};\n};\n\nget_trie = (routes) => {\n  var trie;\n  if (!(trie = forest.get(routes))) {\n    forest.set(routes, trie = make_trie(routes));\n  }\n  return trie;\n};\n\nmatch = (trie, pathname) => {\n  var param, path;\n  path = pathname.split('/');\n  param = {};\n  return walk_trie(param, trie, path, 1, _fallback);\n};\n\nwalk_trie = (param, trie, path, position, fallback) => {\n  var Page, named, step, sub_trie;\n  fallback = trie[WILDCARD] || fallback;\n  if (step = path[position]) {\n    if (sub_trie = trie[step]) {\n      walk_trie(param, sub_trie, path, position + 1, fallback);\n    } else if (named = trie[NAMED]) {\n      named(param, trie, path, position, () => {\n        return fallback(param, trie, path, position);\n      });\n    } else {\n      fallback(param, trie, path, position);\n    }\n  } else if (Page = trie[LEAF]) {\n    _props = {param};\n    _Page = Page;\n  } else {\n    fallback(param, trie, path, position);\n  }\n};\n\nmake_trie = (routes) => {\n  var k, pos, route, trie, v;\n  trie = {};\n  for (k in routes) {\n    v = routes[k];\n    route = k.split('/');\n    pos = 0;\n    if ((route[1] != null) && !route[0]) {\n      pos = 1;\n    }\n    if (typeof v === 'object') {\n      // Nested router\n      Object.assign(grow_trie(trie, route, pos), get_trie(v)); // function Page\n    } else {\n      grow_trie(trie, route, pos, v);\n    }\n  }\n  return trie;\n};\n\ngrow_trie = (trie, route, position, Page) => {\n  var first_char, name, named_trie, step;\n  if (step = route[position]) {\n    first_char = step.charCodeAt(0);\n    if (first_char === 58) { // starts with `:`\n      name = step.slice(1);\n      named_trie = trie[NAMED] || (trie[NAMED] = (param, trie, path, position, fallback) => {\n        fallback = trie[WILDCARD] || fallback;\n        param = {...param};\n        param[name] = path[position];\n        walk_trie(param, named_trie, path, position + 1, fallback);\n      });\n      return grow_trie(named_trie, route, position + 1, Page);\n    } else if (first_char === 42) { // starts with `*`\n      trie[WILDCARD] = (param, trie, path, position) => {\n        var wild;\n        wild = path.slice(position);\n        _props = {param, wild};\n        _Page = Page;\n      };\n      return trie;\n    } else {\n      return grow_trie((trie[step] || (trie[step] = {})), route, position + 1, Page);\n    }\n  } else {\n    if (Page) {\n      trie[LEAF] = Page;\n    }\n    return trie;\n  }\n};\n","// Generated by CoffeeScript 2.4.1\n// # ![PlayFrame](https://avatars3.githubusercontent.com/u/47147479)\n\n// ###### 4 kB 60 fps Functional SPA/PWA Framework\n\n// [framesync](https://github.com/Popmotion/popmotion/tree/master/packages/framesync) +\n// [React](https://github.com/facebook/react/) +\n// [Redux](https://github.com/reduxjs/redux) +\n// [router](https://github.com/playframe/router) +\n// [Shadow Dom](https://developers.google.com/web/fundamentals/web-components/shadowdom)\n// alike minimalistic functional framework built to be able to update DOM\n// up to 60 times per second.\n// [Components](https://github.com/playframe/component) can\n// rerender independently from the rest of the app and\n// only if their local state is changed\n\n// High-performance server-side rendering for PWA support is coming soon\n\n// ##### SPA Example\n// ```js\n// import {h, app, mount} from '@playframe/playframe'\n// app({\n//   // state\n//   counter: 1,\n//   // actions\n//   _: {\n//     inc: (e, state)=> state.counter++, // mutating\n//     dec: (e, {counter})=> ({counter: counter - 1}) // or returning object\n//   }\n// })( // view\n//   (state)=>\n//     <div>\n//       <h1>Counter: {state.counter}</h1>\n//       <button onclick={state._.inc}>Increment</button>\n//       <button onclick={state._.dec}>Decrement</button>\n//     </div>\n//   }\n// )( // dom container\n//   mount(document.body)\n// )\n// ```\n\n// ##### Routed Example\n// ```js\n// import {h, route, mount} from '@playframe/playframe'\n// route({\n//   greeting: \"Hello\",\n//   routes: {\n//     '/': ()=> <a href=\"/hello/world\"><h1>Link</h1></a>,\n//     '/hello/:name': ({state, param})=> <h1>{state.greeting} {param.name}!</h1>,\n//     '/*': ()=>  <h1>404</h1>\n//   }\n// })(\n//   mount(document.body)\n// )\n// ```\n\n// ## Installation\n// Using npm or yarn:\n// ```sh\n// npm i @playframe/playframe\n// ```\n\n// Using UNPKG for es6 bundle:\n// ```uri\n// https://unpkg.com/@playframe/playframe@1.0.2/dist/playframe.min.js\n// ```\n\n// ## API\n\n// #### `PlayFrame.app(state_actions)(View)(container)`:\n// Creates a new `app` and mounts it into `container`. Initial `state_actions` will\n// create a [`statue`](https://github.com/playframe/statue)\n// instance that will be passed into the `View` function. If state is modified by\n// actions, app is rerendered. Returns `statue` instance\n\n// #### `PlayFrame.route(state_actions)(container)`:\n// Creates a new [routed](https://github.com/playframe/router)\n// app and mounts it into `container`. Initial `state_actions`\n// should have a `routes` property. Returns `statue` instance\n\n// #### `PlayFrame.mount(domNode)`:\n// Creates a [ShaDOM](https://github.com/playframe/shadom)\n// container for managing DOM mutations\n\n// #### `PlayFrame.h(nodeName, attributes, children...)`:\n// Returns a lightweight [Virtual DOM](https://github.com/playframe/h)\n// node. If you are using JSX you might need\n// `[\"@babel/plugin-transform-react-jsx\", { \"pragma\": \"h\" }]`. Or you could use\n// [rollup](https://github.com/rollup/rollup)\n// with [buble](https://github.com/rollup/rollup-plugin-buble)({jsx: 'h'})\n\n// #### `PlayFrame.Component(state_actions)(View)(upgrade)(props)`:\n// Creates a [Stateful Web Component](https://github.com/playframe/component)\n// function for given `state_actions`, `View` and\n// `upgrade`. `upgrade` will extend `state_actions` by using\n// [`evolve`](https://github.com/playframe/evolve) function. Passing `props` to\n// Component function will return Virtual DOM nodes. Styles are incaplulated by\n// [Shadow Dom](https://developers.google.com/web/fundamentals/web-components/shadowdom).\n// Example:\n// ```js\n// const createHover = PlayFrame.Component({\n//   i: 0,\n//   _: {add: (e, state)=> state.i++}\n// })((state)=>\n//   <my-hover onhover={state._.add}>\n//     <style>{`\n//       :host {\n//         display: block;\n//         border: ${state.i}px;\n//       }\n//     `}</style>\n//     <h6>This was hovered {state.i} time(s)</h6>\n//   </my-hover>\n// )\n// let Hover = createHover()\n// let View = (state)=> <Hover></Hover>\n// ```\n\n// #### `PlayFrame.use(pureComponents)`:\n// Registering custom elements for Pure Components. Example:\n// ```js\n// PlayFrame.use({\n//   'custom-heading': (props)=> <h1>{props.children}</h1>\n// })\n// const View = ()=> <custom-heading>Hello!</custom-heading>\n// ```\n\n// #### `PlayFrame.reuse(statefulComponents)`:\n// Registering custom elements for\n// [Stateful Components](https://github.com/playframe/component).\n// To reuse the same Component\n// instances we cache them in\n// [WeakMap](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/WeakMap)\n// by `mkey` property which needs to be an object, not a primitive value.\n// Example:\n// ```js\n// PlayFrame.reuse({\n//   'my-hover': createHover\n// })\n// const hovers = [{}, {}, {}]\n// const View = (state)=> hovers.map((obj)=>\n//   <my-hover mkey={obj}></my-hover>\n// )\n// ```\n\n// ### Internal functions\n\n// #### `PlayFrame.statue(state_actions, delayed, subscribe)`:\n// Creates a [statue](https://github.com/playframe/shadom) state machine\n// for a `state_actions` object. `delayed` will throttle state updates and\n// latest state will be passed to `subscribe` function. Example:\n// ```js\n// const state_actions = {\n//   // state\n//   i: 0,\n//   // actions\n//   _: { add: (e, state)=> state.i++ },\n//   subCounter: {\n//     // nested state\n//     i: 0,\n//     // nested actions\n//     _: { add: (e, state)=> state.i++ },\n//   }\n// }\n// state = PlayFrame.statue(state_actions, requestIdleCallback, (state)=>\n//   console.log(state)\n// )\n// state._.add()\n// state.subCounter._.add()\n// // Will log on idle\n// // {i: 1, subCounter: {i: 1, _: {add}}, _: {add}}\n// ```\n\n// #### `PlayFrame.evolve(base, upgrade)`:\n// [`evolve`](https://github.com/playframe/evolve)\n// function for deep object extending. If any value in `upgrade` is a function it\n// will be called with existing value as an argument. Example:\n// ```js\n// const base = {\n//   i: 1,\n//   j: 2,\n//   onclick: (e)=>{}\n// }\n// const upgrade = {\n//   i: 10, // overwrite value\n//   j: (j)=> j * 2, // double existing value\n//   onclick: (onclick)=>(e)=> { // compose functions\n//     console.log('click')\n//     onclick(e); // original handler\n//   }\n// console.log(PlayFrame.evolve(base, upgrade))\n// // {i: 10, j: 4, onclick: loggedOnClick}\n// }\n// ```\n\n// #### `PlayFrame.sync.{next, catch, then, finally, render, frame}`:\n// Initialized instance of [OverSync](https://github.com/playframe/oversync) that\n// helps different parts of framework synchronize execution within the unified frame\n// rendering flow\n\n// ## Source\nvar app, h, router, statue, sync, use;\n\nsync = require('@playframe/oversync')(Date.now, requestAnimationFrame);\n\nexports.sync = sync;\n\nexports.Component = require('@playframe/component')(sync);\n\nexports.mount = require('@playframe/shadom')(sync);\n\nrouter = require('@playframe/router')(sync);\n\nexports.statue = statue = require('@playframe/statue');\n\nexports.evolve = require('@playframe/evolve');\n\nexports.app = app = (state_actions) => {\n  return (view) => {\n    return (container) => {\n      var state;\n      state_actions._ || (state_actions._ = {});\n      state = statue(state_actions, sync.finally, (state) => {\n        return container(view, state);\n      });\n      container(view, state);\n      return state;\n    };\n  };\n};\n\nexports.route = (state_actions) => {\n  return app(state_actions)(router);\n};\n\nexports.h = h = require('@playframe/h');\n\nexports.use = use = h.use;\n\nexports.reuse = (components) => {\n  var Component, k, purified;\n  purified = {};\n  for (k in components) {\n    Component = components[k];\n    purified[k] = (props) => {\n      var mkey;\n      mkey = props && props.mkey;\n      return Component(mkey && {mkey})(props);\n    };\n  }\n  use(purified);\n};\n","import {h} from '@playframe/playframe'\nimport {toFixed} from '../util'\n\nexport default ({,account, market, buy_form, sell_form, tokenA, tokenB, web3_wallet})=>\n  # TODO form validation\n  # TODO check token balance and allowance before committing\n  # TODO reset form after submission?\n  <div class=\"row\">\n    <div class=\"col-md-6 my-5\">\n      <h5 class=\"text-center\">COMMIT TO BUY</h5>\n      <form\n        class=\"card border-0\"\n        onsubmit={(e)=>\n          e.preventDefault()\n          market._.limitBuy\n            token: tokenA.address\n            quoteToken: tokenB.address\n            amount: buy_form.values.amount\n            price: buy_form.values['price limit']\n          }>\n        <div class=\"card-body pb-0\">\n          {TokenInput buy_form, tokenB, 'price limit', 'total', 'buy'}\n          {TokenInput buy_form, tokenA, 'amount', 'total', 'buy'}\n          <hr/>\n          {TokenInput buy_form, tokenB, 'total', 'amount', 'buy'}\n          <hr/>\n          <button\n            disabled={not account.isSignedIn || not web3_wallet.get_address()}\n            type=\"submit\" class=\"btn btn-block btn-outline-success rounded-pill text-right\"\n          >\n            { if account.isSignedIn\n                <span>\n                  <span class=\"d-none d-sm-inline d-md-none d-lg-inline\">COMMIT TO </span>\n                  BUY\n                  <small class=\"tabular\">\n                    {' '}{toFixed(buy_form.values.amount, tokenA.decimals)}{' '}\n                  </small><small class=\"tabular\"> {tokenA.symbol}</small>\n                  {<br/> if buy_form.values.total or buy_form.values.total is 0}\n                  <span class=\"#{'d-none d-sm-inline d-md-none' if buy_form.values.total} d-lg-inline\">{' FOR '}</span>\n                  {'TOTAL ' if buy_form.values.total}\n                  <small class=\"tabular\">\n                    {' '}{toFixed(buy_form.values.total, tokenB.decimals)}{' '}\n                  </small><small class=\"tabular\"> {tokenB.symbol}</small>\n                </span>\n            else\n              'SIGN IN TO COMMIT'\n            }\n          </button>\n        </div>\n\n        { market.buy_commits.map (order)=>\n          {amount, price, blockHash, revealing, revealed, clearing, cleared, evicted} = order\n          <div class=\"btn-group btn-group-sm mt-1\" style={opacity: (cleared or evicted) and .7 or 1}>\n            <button disabled class=\"btn text-light\">\n              <span class=\"text-success tabular\">{toFixed(price, tokenB.decimals)}</span>\n              <span class=\"tabular\"> Ã— {toFixed(amount, tokenA.decimals)}</span>\n            </button>\n            { if blockHash and not (revealing or revealed or cleared or evicted)\n                <button type=\"button\" class=\"btn btn-outline-success rounded-pill\"\n                        style={flex: 3}\n                        onclick={market._.reveal order}>\n                  REVEAL\n                </button>\n            }\n            { if not (cleared or evicted) and ((not blockHash) or revealing or clearing)\n                <button disabled class=\"btn\"\n                        style={flex: 3}\n                        onclick={market._.reveal order}>\n                  <div class=\"progress border border-success rounded-pill\">\n                    <div class=\"progress-bar progress-bar-striped progress-bar-animated bg-success\"\n                         style=\"width: #{ clearing and 75 or revealing and 50 or 25 }%\"></div>\n                  </div>\n                </button>\n            }\n            { if cleared\n              <button disabled class=\"btn text-light\">\n                CLEARED\n              </button>\n            }\n            { if evicted\n              <button disabled class=\"btn text-danger\">\n                EVICTED\n              </button>\n            }\n          </div>\n        }\n      </form>\n    </div>\n    <div class=\"col-md-6 my-5\">\n      <h5 class=\"text-center\">COMMIT TO SELL</h5>\n      <form class=\"card border-0\" onsubmit={(e)=>\n            e.preventDefault()\n            market._.limitSell\n              token: tokenA.address\n              quoteToken: tokenB.address\n              amount: sell_form.values.amount\n              price: sell_form.values['price limit']\n          }>\n        <div class=\"card-body pb-0\">\n          {TokenInput sell_form, tokenB, 'price limit', 'total', 'sell'}\n          {TokenInput sell_form, tokenA, 'amount', 'total', 'sell'}\n          <hr/>\n          {TokenInput sell_form, tokenB, 'total', 'amount', 'sell'}\n          <hr/>\n          <button\n            disabled={not account.isSignedIn || not web3_wallet.get_address()}\n            type=\"submit\" class=\"btn btn-block btn-outline-warning rounded-pill text-right\"\n          >\n            { if account.isSignedIn\n              <span>\n                <span class=\"d-none d-sm-inline d-md-none d-lg-inline\">COMMIT TO </span>\n                SELL\n                <small class=\"tabular\">\n                  {' '}{toFixed(sell_form.values.amount, tokenA.decimals)}{' '}\n                </small><small class=\"tabular\"> {tokenA.symbol}</small>\n                  {<br/> if sell_form.values.total or sell_form.values.total is 0}\n                  <span class=\"#{'d-none d-sm-inline d-md-none' if sell_form.values.total} d-lg-inline\">{' FOR '}</span>\n                  {'TOTAL ' if sell_form.values.total}\n                  <small class=\"tabular\">\n                    {toFixed(sell_form.values.total, tokenB.decimals)}{' '}\n                  </small><small class=\"tabular\"> {tokenB.symbol}</small>\n              </span>\n            else\n              'SIGN IN TO COMMIT'\n            }\n          </button>\n        </div>\n\n        { market.sell_commits.map (order)=>\n          {amount, price, blockHash, revealing, revealed, clearing, cleared, evicted} = order\n          <div class=\"btn-group btn-group-sm mt-1\" style={opacity: (cleared or evicted) and .7 or 1}>\n            <button disabled class=\"btn text-light\">\n              <span class=\"text-warning tabular\">{toFixed(price, tokenB.decimals)}</span>\n              <span class=\"tabular\"> Ã— {toFixed(amount, tokenA.decimals)}</span>\n            </button>\n            { if blockHash and not (revealing or revealed or cleared or evicted)\n              <button type=\"button\" class=\"btn btn-outline-warning rounded-pill\"\n                      style={flex: 3}\n                      onclick={market._.reveal order}>\n                REVEAL\n              </button>\n            }\n            { if not (cleared or evicted) and ((not blockHash) or revealing or clearing)\n              <button disabled class=\"btn\"\n                      style={flex: 3}\n                      onclick={market._.reveal order}>\n                <div class=\"progress border border-warning rounded-pill\">\n                  <div class=\"progress-bar progress-bar-striped progress-bar-animated bg-warning\"\n                       style=\"width: #{ clearing and 75 or revealing and 50 or 25 }%\"></div>\n                </div>\n              </button>\n            }\n            { if cleared\n              <button disabled class=\"btn text-light\">\n                CLEARED\n              </button>\n            }\n            { if evicted\n              <button disabled class=\"btn text-danger\">\n                EVICTED\n              </button>\n            }\n          </div>\n        }\n      </form>\n    </div>\n  </div>\n\n\n\n_debounce_id = 0\ndebounce = (time)=>(fn)=>(args...)=>\n  clearTimeout _debounce_id\n  _debounce_id = setTimeout fn, time, args...\n  return\n\nstop_bounce = (fn)=>(args...)=>\n  clearTimeout _debounce_id\n  fn args...\n\n\nTokenInput = (form, token, field, adjust, prefix)=>\n  <div class=\"form-group row\">\n    <label\n        class=\"col-sm-3 col-md-12 col-lg-3 col-form-label text-right text-nowrap text-uppercase\"\n        for=\"#{prefix}_#{field.replace /\\s+/g, '_'}\">\n      <small>{field}</small>\n    </label>\n\n    <div class=\"col-sm-9 col-md-12 col-lg-9 input-group\">\n      <input\n        class=\"form-control text-right\"\n        type=\"text\"\n        inputmode=\"decimal\"\n        id=\"#{prefix}_#{field.replace /\\s+/g, '_'}\"\n        placeholder={toFixed 0, token.decimals}\n        required\n        pattern=\"[0-9]*.?[0-9]*\"\n        title=\"Please enter your desired number\"\n        autocomplete=\"off\"\n        onchange={stop_bounce form._.readNumberAndAdjust(field)(adjust)(token.decimals)}\n        onkeyup={debounce(166) form._.readNumberAndAdjust(field)(adjust)(token.decimals)}\n        oncreate={form._.updateInputValue(field)(token.decimals)}\n        onupdate={form._.updateInputValue(field)(token.decimals)}\n      />\n      <div class=\"input-group-append\">\n        <div class=\"input-group-text bg-dark text-white-50 tabular\">{token.symbol}</div>\n      </div>\n    </div>\n  </div>\n","export DOMAIN = 'ethereal.market' # cloudflare\n# TODO use cloudflare for calls and infura for subs\nexport CDN_WEB3_PROVIDER = 'wss://mainnet.infura.io/ws/v3/354f99d9209b4e8a9f643e61bc3a2d9f' # infura\nexport WBTC_TOKEN = '0x2260FAC5E5542a773Aa44fBCfeDf7C193bc2C599'\nexport WETH_TOKEN = '0xC02aaA39b223FE8D0A0e5C4F27eAD9083C756Cc2'\n","export toFixed = (number, decimals)=>\n  decimals or= 8 # TODO maybe remove\n  decimals = Math.min decimals, 8\n  if (not number and number != 0) or isNaN number\n    ''\n  else\n    number.toFixed decimals\n\nexport toBigString = (number)=>\n  number.toLocaleString 'en', useGrouping: false, maximumFractionDigits: 0\n\n\n","import {h} from '@playframe/playframe'\nimport NavBar from './components/NavBar'\nimport Intro from './components/Intro'\nimport Tokens from './components/Tokens'\nimport Forms from './components/Forms'\nimport Book from './components/Book'\nimport History from './components/History'\nimport {DOMAIN} from './config'\n\nexport default View = (state)=>\n  {account, market, tokenA, tokenB, rainbow} = state\n\n  account._.init()\n  market._.init()\n  tokenA._.init()\n  tokenB._.init()\n  rainbow._.init()\n\n\n  market.on_balance_update = debounce(500) =>\n    tokenA._.getBalance()\n    tokenA._.getAllowance()\n    tokenB._.getBalance()\n    tokenB._.getAllowance()\n\n\n  <div class=\"container d-flex w-100 h-100 p-3 mx-auto flex-column\"\n    onupdate={=>\n      Object.assign document.documentElement.style, rainbow.style\n      Object.assign document.body.style, rainbow.style\n    }\n  >\n    {NavBar state}\n\n    <main role=\"main\" class=\"inner\">\n      {Intro state}\n      {Tokens state}\n      {Forms state}\n      {Book state}\n      {History state}\n    </main>\n\n    <footer class=\"mastfoot mt-auto\">\n      <div class=\"inner text-center\">\n        <small><span class=\"tabular\">{DOMAIN}</span> is not a registered national securities exchange,\n          but an <a target=\"_blank\" href=\"https://github.com/ethereal-market/market\">\n            autonomous smart contract software program\n        </a> running on <a target=\"_blank\" href=\"https://www.ethereum.org/\">\n            Ethereum blockchain</a></small>\n      </div>\n    </footer>\n  </div>\n\n\n\n_debounce_id = 0\ndebounce = (time)=>(fn)=>(args...)=>\n  clearTimeout _debounce_id\n  _debounce_id = setTimeout fn, time, args...\n  return\n","import {CDN_WEB3_PROVIDER} from \"../config\"\n\n\n_debounce_id = 0\ndebounce = (time)=>(fn)=>(args...)=>\n  clearTimeout _debounce_id\n  _debounce_id = setTimeout fn, time, args...\n  return\n\nreload = debounce(300) => location.reload()\n\n\nif window.ethereum\n  ethereum.autoRefreshOnNetworkChange = false\n  ethereum.on? 'networkChanged', (net)=> check_network net unless net is 'loading'\n  ethereum.on? 'accountsChanged', (accounts)=> reload() unless accounts is 'loading'\n\n  web3_instance = if window.Web3\n    new Web3 ethereum\n  else\n    window.web3\n\n\nelse if window.web3\n  web3_instance = if window.Web3\n    new Web3 web3.currentProvider\n  else\n    window.web3\n\n  _address = \"\"\n  web3_instance\n    .currentProvider\n    .publicConfigStore?.on 'update', ({networkVersion, selectedAddress})=>\n      check_network networkVersion\n      if _address and _address isnt selectedAddress\n        reload()\n      else\n        _address = selectedAddress\nelse\n  console.info 'Error: no web3 wallet found'\n\n\nweb3_instance?.version?.getNetwork (err, net_id) =>\n  check_network net_id\n\n\ncheck_network = (net_id)=>\n  current = localStorage['eth_net_id'] or '1'\n\n  unless current is net_id\n    localStorage['eth_net_id'] = net_id\n    reload()\n\nexport default web3_wallet =\n  get_address: if window.ethereum\n    => ethereum.selectedAddress or ''\n  else if web3_instance\n    => web3_instance.eth?.defaultAccount\n  else\n    =>\n\n  get_balance: (address)=> new Promise (resolve, reject)=>\n    resolve '' unless web3_instance?.eth?.getBalance\n    web3_instance.eth.getBalance address, (err, data)=>\n      if err then reject err else resolve data\n\n\neth_net_id = localStorage['eth_net_id'] or '1'\nexport net_provider = if eth_net_id is '1' # mainnet\n  # TODO use cloudflare for calls and infura for subs\n  new Web3ProviderWS CDN_WEB3_PROVIDER\nelse\n  window.ethereum or web3_instance?.currentProvider\n\n\nexport wallet_provider = window.ethereum or web3_instance?.currentProvider\n","import {h} from '@playframe/playframe'\nimport {DOMAIN} from '../config'\n\nexport default ({show_intro, show_menu, market, account, web3_wallet, _})=>\n  <header class=\"masthead mb-auto\">\n    <div class=\"inner\">\n      <a class=\"navbar-brand tabular\"\n           style={fontWeight: 100, cursor: 'pointer'}\n           onclick={(e)=>\n             e.preventDefault()\n             _ show_intro: !show_intro\n             if show_intro\n               localStorage['hide_intro'] = true\n             else\n               delete localStorage['hide_intro']\n           }\n      >\n        <img class=\"d-inline-block mr-3\" src=\"ethereal-192.png\"\n             style={height: '3rem', width: '3rem'} />\n        <div class=\"d-inline-block position-absolute\">\n          <span class=\"ethereal\">{DOMAIN}</span>\n          <br/>\n          <sup class=\"d-none d-lg-inline\"><small>{market.address}</small></sup>\n        </div>\n      </a>\n      <nav class=\"nav nav-masthead justify-content-center\">\n        { if account.isSignedIn\n            <div class=\"nav-item dropdown #{'show' if show_menu}\">\n              <a class=\"nav-link dropdown-toggle text-left\" href=\"##\"\n                 onclick={(e)=> e.preventDefault(); _ show_menu: !show_menu}>\n                <span class=\"ethereal\">{ account.name }</span>\n                <br/>\n                <small class=\"tabular d-none d-sm-inline\">\n                 {if web3_wallet.get_address()\n                   web3_wallet.get_address()}\n                 {unless web3_wallet.get_address()\n                    \"Please connect your #{\n                      window.ethereum and ethereum.isMetaMask and 'Metamask ' or ''\n                    }Wallet\"}\n                </small>\n              </a>\n              <div class=\"#{'show' if show_menu} dropdown-menu dropdown-menu-right w-100 text-right\">\n                { if window.ethereum and not web3_wallet.get_address() and ethereum.enable\n                    [\n                      <a class=\"dropdown-item tabular\"\n                         href=\"#\"\n                         onclick={(e)=> e.preventDefault(); ethereum.enable().then => location.reload()}\n                      >\n                        Connect your Wallet\n                      </a>\n                      <div class=\"dropdown-divider\"></div>\n                    ]\n                }\n                <a class=\"dropdown-item tabular\" target=\"_blank\"\n                   href=\"https://browser.blockstack.org/profiles\"\n                >\n                  {account.username.replace /\\..*\\..*$/i, ''\n                  }<small>.id.blockstack</small>\n                </a>\n                <div class=\"dropdown-divider\"></div>\n                <a class=\"dropdown-item\" href=\"#\" onclick={(e)=>\n                    e.preventDefault()\n                    account._.signout()\n                }>\n                  Sign out\n                </a>\n              </div>\n            </div>\n          else if account.userSession\n            <a class=\"nav-link\" href=\"#\" onclick={(e)=>\n              e.preventDefault()\n              account._.signin()\n            }>Sign in with Blockstack</a>\n        }\n      </nav>\n    </div>\n  </header>\n\n","import {h} from '@playframe/playframe'\nimport {DOMAIN} from '../config'\n\nexport default ({show_intro, _})=>\n  return unless show_intro\n  <div class=\"jumbotron bg-dark my-5\">\n    <div class=\"text-right\">\n      <h1 class=\"display-1 d-none d-md-block mb-5\">\n        the most secure\n        <br/>token exchange\n        <br/>on the planet\n      </h1>\n      <h4 class=\"display-5 d-none d-md-block\">\n        fully <span class=\"tabular\">decentralized</span>\n      </h4>\n      <h3 class=\"display-4\">\n        priced p2p token swaps\n      </h3>\n      <h6>\n        More ERC20 tokens are coming on\n        October <span class=\"tabular\">1</span>st, <span class=\"tabular\">2019</span>\n      </h6>\n    </div>\n    <div class=\"row\">\n      <div class=\"col-lg\">\n        <hr class=\"my-4\"/>\n        <p class=\"lead\">\n          Secure ERC20 token swapping means you are protected from\n          things like front running, high-frequency trading or transaction reordering.\n          It is ensured by a cryptographic commit/reveal process:\n          <ul>\n            <li>Unique but random looking hash corresponding to your swap\n              is getting committed to reserve your spot in the market execution order.</li>\n\n            <li>Reveals are submitted 3 - 5 blocks after commits. Reveals are price-matched and executed\n              in the same order as commits came in. Swap confirmation time would take only\n              3 - 5 blocks longer than a regular Ethereum transaction (about 30 - 60 seconds longer).\n              If someone decides not to reveal their commit, market would hold execution\n              of that swap pair for 7 blocks before evicting such commit. This round would take\n              7 blocks to clear (2 minutes).\n            </li>\n\n            <li>There is no maker/taker commission but there will be a fixed fee (disabled for now)\n              to commit a swap: {1e6.toLocaleString()} gas paid in ETH.\n              This is required to prevent spamming and demotivate gas price manipulation.\n              The fee is about $0.50 to submit a slow commit and goes up\n              as you increase your gas price.</li>\n\n            <li>Your tokens are kept in your wallet all the time and swapped directly\n              into counter-party wallet when matching counter-commit appears.\n              If tokens are not present in your wallet at such moment, your commit gets evicted.\n            </li>\n\n          </ul>\n        </p>\n      </div>\n      <div class=\"col-lg\">\n        <hr class=\"my-4\"/>\n        <p class=\"lead\">\n          Full decentralization:\n          <ul>\n            <li>\n              <a target=\"_blank\" href=\"https://blockstack.org/technology\">\n                Blockstack authentication and storage\n              </a> for user accounts and private data.</li>\n\n            <li>Secure IPFS site hosting with\n              <a target=\"_blank\" href=\"https://www.cloudflare.com/distributed-web-gateway/\">Cloudflare distributed web gateway</a>.</li>\n\n            <li>All market functionality is implemented in\n              an autonomous smart-contract on Ethereum blockchain.\n              This includes  commit/reveal book, buy/sell swap request books, price matching engine\n              and wallet to wallet clearance.\n            </li>\n\n            <li>\n              Pure peer to peer swapping. Tokens are never held in custody,\n              they are transferred directly from wallet to wallet.\n            </li>\n\n            <li>\n              This app communicates only with Blockstack and Ethereum blockchains.\n              No backend servers, no user tracking, no cookies.\n            </li>\n\n            <li>Open source: you can inspect the source code on\n              <a href=\"https://github.com/ethereal-market/market\">Github</a>.</li>\n\n            <li><span class=\"tabular\">{DOMAIN}</span> is\n              a cryptographically secure sorted message board.\n              Each message represents an intent to swap one token for another.\n              When you reveal your intent and matching counter-intent already exists on that board,\n              your reveal is allowing you to take tokens from that counter-wallet and\n              transfer your tokens instead.\n            </li>\n          </ul>\n        </p>\n      </div>\n\n    </div>\n    <hr class=\"my-4\"/>\n    <p class=\"lead\">\n      This is Mainnet public beta:\n      <ul>\n        <li>Make sure you have installed Metamask browser extension or using any\n          other Web3 compatible wallet.</li>\n\n        <li>If you are on the phone you can use Cipher Browser, Coinbase wallet, Opera Touch or other</li>\n\n        <li>You are able to buy and sell Wrapped Ether (WETH) for Wrapped Bitcoin (WBTC)</li>\n\n        <li>You can convert ETH to WETH by simply wrapping it</li>\n\n        <li>Add token addresses to you Wallet to see it appear there</li>\n\n        <li>If you have Ropsten or Kovan ETH you can select\n          Ropsten or Kovan Test Network in your wallet.</li>\n\n        <li>Please approve market to swap tokens for you.</li>\n\n        <li>Submit your first commit and then reveal it to start swapping.</li>\n\n        <li>When you commit or reveal and wallet pops up,\n          remember set the gas price and pick average or fast TX time.</li>\n      </ul>\n    </p>\n    <hr class=\"my-4\"/>\n    <button class=\"btn btn-dark btn-lg float-right\"\n            onclick={=>\n              _ show_intro: false\n              localStorage['hide_intro'] = true\n              setTimeout (=> scrollTo 0, 0), 33\n            }\n    >\n      Happy swapping!\n    </button>\n  </div>\n","import {h} from '@playframe/playframe'\nimport {WBTC_TOKEN, WETH_TOKEN} from \"../config\"\nimport {toFixed} from '../util'\n\nexport default ({tokenA, tokenB, web3_wallet})=>\n  <div class=\"row my-5 text-right\">\n    <div class=\"col-md-6 my-3 card border-0\">\n      <div class=\"card-body\">\n        <h5 class=\"text-center\">\n          {tokenB.name or ' '}\n          { if tokenB.loading\n            <span class=\"spinner-grow spinner-grow-sm position-absolute ml-2\" />}\n        </h5>\n        { if tokenB.address is WBTC_TOKEN\n          <a target=\"_blank\" href=\"https://www.wbtc.network/\">wbtc.network</a>\n        }\n        <div class=\"my-1\">\n          <small class=\"tabular text-break\">{tokenB.address}</small>\n        </div>\n        <hr/>\n        <div class=\"row my-1\">\n          <div class=\"col-5\"><small>BALANCE</small></div>\n          <div class=\"col-7 tabular\">\n            {toFixed(tokenB.balance or 0, tokenB.decimals)}\n            <span class=\"d-md-none d-lg-inline\"> {tokenB.symbol}</span>\n          </div>\n        </div>\n        <div class=\"row my-1\">\n          <div class=\"col-5\"><small>SWAP LIMIT</small></div>\n          <div class=\"col-7 tabular\">\n            {toFixed(tokenB.allowance or 0, tokenB.decimals)}\n            <span class=\"d-md-none d-lg-inline\"> {tokenB.symbol}</span>\n          </div>\n        </div>\n        <hr/>\n        <div class=\"btn-group btn-group-sm my-1 float-right\">\n          { unless tokenB.address is WBTC_TOKEN\n            <button class=\"btn btn-outline-secondary\"\n                    disabled={not web3_wallet.get_address() or tokenB.minting}\n                    onclick={tokenB._.mint 1000}>\n              { if tokenB.minting\n                <span class=\"spinner-grow spinner-grow-sm mr-2\"></span>\n              }\n              MINT\n            </button>\n          }\n          <button class=\"btn btn-outline-secondary\"\n                  disabled={not web3_wallet.get_address() or tokenB.approving}\n                  onclick={tokenB._.approve tokenB.balance}>\n            { if tokenB.approving\n              <span class=\"spinner-grow spinner-grow-sm mr-2\"></span>\n            }\n            APPROVE SWAPS\n          </button>\n        </div>\n      </div>\n    </div>\n    <div class=\"col-md-6 my-3 card border-0\">\n      <div class=\"card-body\">\n        <h5 class=\"text-center\">\n          {tokenA.name or ' '}\n          { if tokenB.loading\n            <span class=\"spinner-grow spinner-grow-sm position-absolute ml-2\" />}\n        </h5>\n        { if tokenA.address is WETH_TOKEN\n          [\n            <a class=\"mr-4\" target=\"_blank\" href=\"https://0x.org/portal/weth\">\n              <span class=\"tabular\">0</span>x/weth\n            </a>\n            <a target=\"_blank\" href=\"https://weth.io/\">weth.io</a>\n          ]\n        }\n        <div class=\"my-1\">\n          <small class=\"tabular text-break\">{tokenA.address}</small>\n        </div>\n        <hr/>\n        <div class=\"row my-1\">\n          <div class=\"col-5\"><small>BALANCE</small></div>\n          <div class=\"col-7 tabular\">\n            {toFixed(tokenA.balance or 0, tokenA.decimals)}\n            <span class=\"d-md-none d-lg-inline\"> {tokenA.symbol}</span>\n          </div>\n        </div>\n        <div class=\"row my-1\">\n          <div class=\"col-5\"><small>SWAP LIMIT</small></div>\n          <div class=\"col-7 tabular\">\n            {toFixed(tokenA.allowance or 0, tokenA.decimals)}\n            <span class=\"d-md-none d-lg-inline\"> {tokenA.symbol}</span>\n          </div>\n        </div>\n        <hr/>\n        <div class=\"btn-group btn-group-sm my-1 float-right\">\n          { unless tokenA.address is WETH_TOKEN\n              <button class=\"btn btn-outline-secondary\"\n                      disabled={not web3_wallet.get_address() or tokenA.minting}\n                      onclick={tokenA._.mint 1000}>\n                { if tokenA.minting\n                  <span class=\"spinner-grow spinner-grow-sm mr-2\"></span>\n                }\n                MINT\n              </button>\n          }\n          { if tokenA.address is WETH_TOKEN\n            [\n              <button class=\"btn btn-outline-secondary\"\n                      disabled={not web3_wallet.get_address() or tokenA.wrapping}\n                      onclick={tokenA._.wrap}>\n                { if tokenA.wrapping\n                  <span class=\"spinner-grow spinner-grow-sm mr-2\"></span>\n                }\n                WRAP ETH\n              </button>\n              <button class=\"btn btn-outline-secondary\"\n                      disabled={not web3_wallet.get_address() or tokenA.unwrapping}\n                      onclick={tokenA._.unwrap}>\n                { if tokenA.unwrapping\n                  <span class=\"spinner-grow spinner-grow-sm mr-2\"></span>\n                }\n                UNWRAP\n              </button>\n            ]\n          }\n          <button class=\"btn btn-outline-secondary\"\n                  disabled={not web3_wallet.get_address() or tokenA.approving}\n                  onclick={tokenA._.approve tokenA.balance}>\n            { if tokenA.approving\n              <span class=\"spinner-grow spinner-grow-sm mr-2\"></span>\n            }\n            APPROVE SWAPS\n          </button>\n        </div>\n      </div>\n    </div>\n  </div>\n","import {h} from '@playframe/playframe'\nimport {toFixed} from '../util'\n\nexport default ({my_bids_only, my_offers_only, market, tokenA, tokenB, web3_wallet, _})=>\n  my_bids =\n    market.bids.filter(({wallet})=> wallet.toLowerCase() is web3_wallet.get_address()) or []\n\n  my_offers =\n    market.offers.filter(({wallet})=> wallet.toLowerCase() is web3_wallet.get_address()) or []\n\n  bids = if my_bids_only then my_bids else market.bids\n  offers = if my_offers_only then my_offers else market.offers\n\n  <div class=\"row my-5\">\n    <div class=\"col-lg-6 my-4\">\n      <h5 class=\"text-center\">\n        <div class=\"custom-control custom-switch d-inline-block\">\n          <input type=\"checkbox\"\n              class=\"custom-control-input\"\n              id=\"buy-book-switch\"\n              onchange={(e)=> _ my_bids_only: e.target.checked}\n          />\n          <label class=\"custom-control-label\" for=\"buy-book-switch\"\n              style={opacity: my_bids_only and 1 or .5}\n          >\n            <span class=\"badge badge-dark\">\n              {my_bids.length}\n            </span>\n            MY\n          </label>\n        </div>\n        <span style={opacity: my_bids_only and .5 or 1}> BUY COMMITS\n          { if market.loading_book\n            <span class=\"spinner-grow spinner-grow-sm position-absolute ml-2\"></span>\n          }\n        </span>\n      </h5>\n      <div class=\"scroller rounded-top\">\n        <table class=\"table table-dark table-striped table-hover table-sm\">\n          <thead>\n          <tr>\n            <th class=\"text-right\"><small>\n              PRICE\n            </small></th>\n            <th class=\"text-right tabular\"><small>\n              {tokenA.symbol}\n            </small></th>\n            <th class=\"text-right tabular\"><small>\n              {tokenB.symbol}\n            </small></th>\n            <th class=\"text-right d-none d-md-table-cell\" style={width:'25%'}><small>\n              { if my_bids_only\n                  'ACTION'\n                else\n                  'SUM'\n              }\n              { unless my_bids_only\n                <span class=\"tabular\"> {tokenB.symbol}</span>}\n            </small></th>\n          </tr>\n          </thead>\n          <tbody>\n          { unless bids.length\n            <tr><td class=\"text-center text-white-50\" colSpan=\"5\">\n              <small>{ if market.loading_book\n                  'Loading...'\n                else if my_bids_only\n                  \"You don't have any commits in this book\"\n                else\n                  'There are no commits in this book'\n              }</small>\n            </td></tr>\n          }\n          { sum = 0; bids[0...100].map (bid)=>\n            {id, price, amount, wallet} = bid\n            <tr class=\"#{'bg-dark-success' if web3_wallet.get_address() is wallet.toLowerCase()}\">\n              <td class=\"tabular text-right text-success\"><small>\n                {toFixed(price, tokenB.decimals)}\n              </small></td>\n              <td class=\"tabular text-right\"><small>\n                {toFixed(amount, tokenA.decimals)}\n              </small></td>\n              <td class=\"tabular text-right\"><small>\n                {toFixed(price * amount, tokenB.decimals)}\n              </small></td>\n              <td class=\"tabular text-right d-none d-md-table-cell\">\n                { if my_bids_only\n                  if bid.canceling\n                    [\n                      <span class=\"spinner-grow spinner-grow-sm text-dark\"></span>\n                      <span class=\"spinner-grow spinner-grow-sm text-dark\"></span>\n                      <span class=\"spinner-grow spinner-grow-sm text-dark\"></span>\n                    ]\n                  else\n                    <button class=\"btn btn-dark btn-sm xs rounded-pill\" href=\"#\"\n                            onclick={(e)=> e.preventDefault(); market._.cancel_bid bid}\n                    >\n                      CANCEL\n                    </button>\n                else\n                  <small>{toFixed(sum += price * amount, tokenB.decimals)}</small>\n                }\n              </td>\n            </tr>\n          }\n          </tbody>\n        </table>\n      </div>\n    </div>\n    <div class=\"col-lg-6 my-4\">\n      <h5 class=\"text-center\">\n        <div class=\"custom-control custom-switch d-inline-block\">\n          <input type=\"checkbox\"\n              class=\"custom-control-input\"\n              id=\"sell-book-switch\"\n              onchange={(e)=> _ my_offers_only: e.target.checked}\n          />\n          <label class=\"custom-control-label\" for=\"sell-book-switch\"\n              style={opacity: my_offers_only and 1 or .5}\n          >\n            <span class=\"badge badge-dark\">\n              {my_offers.length}\n            </span>\n            MY\n          </label>\n        </div>\n        <span style={opacity: my_offers_only and .5 or 1}> SELL COMMITS\n          { if market.loading_book\n            <span class=\"spinner-grow spinner-grow-sm position-absolute ml-2\"></span>\n          }\n        </span>\n      </h5>\n      <div class=\"scroller rounded-top\">\n        <table class=\"table table-dark table-striped table-hover table-sm\">\n          <thead>\n          <tr>\n            <th class=\"text-right\"><small>\n              PRICE\n            </small></th>\n            <th class=\"text-right tabular\"><small>\n              {tokenA.symbol}\n            </small></th>\n            <th class=\"text-right tabular\"><small>\n              {tokenB.symbol}\n            </small></th>\n            <th class=\"text-right d-none d-md-table-cell\" style={width:'25%'}><small>\n              { if my_offers_only\n                'ACTION'\n              else\n                'SUM'\n              }\n              { unless my_offers_only\n                <span class=\"tabular\"> {tokenB.symbol}</span>}\n            </small></th>\n          </tr>\n          </thead>\n          <tbody>\n          { unless offers.length\n            <tr><td class=\"text-center text-white-50\" colSpan=\"5\">\n              <small>{ if market.loading_book\n                'Loading...'\n              else if my_offers_only\n                \"You don't have any commits in this book\"\n              else\n                'There are no commits in this book'\n              }</small>\n            </td></tr>\n          }\n          {  sum = 0; offers[0...100].map (offer)=>\n            {id, price, amount, wallet} = offer\n            <tr class=\"#{'bg-dark-warning' if web3_wallet.get_address() is wallet.toLowerCase()}\">\n              <td class=\"tabular text-right text-warning\"><small>\n                {toFixed(price, tokenB.decimals)}\n              </small></td>\n              <td class=\"tabular text-right\"><small>\n                {toFixed(amount, tokenA.decimals)}\n              </small></td>\n              <td class=\"tabular text-right\"><small>\n                {toFixed(price * amount, tokenB.decimals)}\n              </small></td>\n              <td class=\"tabular text-right d-none d-md-table-cell\">\n                { if my_offers_only\n                  if offer.canceling\n                    [\n                      <span class=\"spinner-grow spinner-grow-sm text-dark\"></span>\n                      <span class=\"spinner-grow spinner-grow-sm text-dark\"></span>\n                      <span class=\"spinner-grow spinner-grow-sm text-dark\"></span>\n                    ]\n                  else\n                    <button class=\"btn btn-dark btn-sm xs rounded-pill\" href=\"#\"\n                            onclick={(e)=> e.preventDefault(); market._.cancel_offer offer}\n                    >\n                      CANCEL\n                    </button>\n                else\n                  <small>{toFixed(sum += price * amount, tokenB.decimals)}</small>\n                }\n              </td>\n            </tr>\n          }\n          </tbody>\n        </table>\n      </div>\n    </div>\n  </div>\n","import {h} from '@playframe/playframe'\nimport {toFixed} from '../util'\n\nexport default ({web3_wallet, market, tokenA, tokenB, my_history_only, _})=>\n  my_history =\n    market.history.filter(({maker, taker})=>\n      maker.toLowerCase() is web3_wallet.get_address() or\n      taker.toLowerCase() is web3_wallet.get_address()\n    ) or []\n\n  history = my_history_only and my_history or market.history\n\n\n  <div class=\"row my-5\">\n    <div class=\"col-lg-12\">\n      <h5 class=\"text-center\">\n        <div class=\"custom-control custom-switch d-inline-block\">\n          <input type=\"checkbox\"\n                 class=\"custom-control-input\"\n                 id=\"history-switch\"\n                 onchange={(e)=> _ my_history_only: e.target.checked}\n          />\n          <label class=\"custom-control-label\" for=\"history-switch\"\n                 style={opacity: my_history_only and 1 or .5}\n          >\n            <span class=\"badge badge-dark\">\n              {my_history.length}\n            </span>\n            <span class=\"text\">MY</span>\n          </label>\n        </div>\n        <span style={opacity: my_history_only and .5 or 1}> SWAP HISTORY\n          { if market.loading_history\n            <span class=\"spinner-grow spinner-grow-sm position-absolute ml-2\"></span>\n          }\n        </span>\n      </h5>\n      <div class=\"scroller rounded-top\">\n        <table class=\"table table-dark table-striped table-hover table-sm\">\n          <thead>\n          <tr>\n            <th class=\"text-center d-none d-md-table-cell\"><small>\n              TYPE\n            </small></th>\n            <th class=\"text-right\"><small>\n              PRICE <span class=\"tabular\">{tokenB.symbol}</span>\n            </small></th>\n            <th class=\"text-right\"><small>\n              AMOUNT <span class=\"tabular\">{tokenA.symbol}</span>\n            </small></th>\n            <th class=\"text-right\"><small>\n              AMOUNT <span class=\"tabular\">{tokenB.symbol}</span>\n            </small></th>\n            <th class=\"text-right d-none d-sm-table-cell\"><small>\n              SUM <span class=\"tabular\">{tokenB.symbol}</span>\n            </small></th>\n          </tr>\n          </thead>\n          <tbody>\n          { unless history.length\n            <tr><td class=\"text-center text-white-50\" colSpan=\"5\">\n              <small>{ if market.loading_history\n                  'Loading...'\n                else if my_history_only\n                  \"You haven't swapped yet\"\n                else\n                 'No swaps happened yet'\n              }</small>\n            </td></tr>\n          }\n          { sum = 0; history[0...100].map ({swapType, price, amount, maker, taker})=>\n            <tr class={if web3_wallet.get_address()\n              if web3_wallet.get_address() is taker.toLowerCase()\n                if swapType is 'BUY'\n                  'bg-dark-success'\n                else\n                  'bg-dark-warning'\n              else if web3_wallet.get_address() is maker.toLowerCase()\n                if swapType is 'BUY'\n                  'bg-dark-warning'\n                else\n                  'bg-dark-success'\n            }>\n              <td class=\"tabular text-center d-none d-md-table-cell #{\n                      if swapType is 'BUY' then 'text-success' else 'text-warning'\n                    }\"><small>\n                { if my_history_only\n                    if web3_wallet.get_address() is taker.toLowerCase()\n                      swapType\n                    else if web3_wallet.get_address() is maker.toLowerCase()\n                      if swapType is 'BUY'\n                        'SELL'\n                      else\n                        'BUY'\n                  else\n                    swapType\n                }\n              </small></td>\n              <td class=\"tabular text-right #{\n                      if swapType is 'BUY' then 'text-success' else 'text-warning'\n                    }\"><small>\n                {toFixed(price, tokenB.decimals)}\n              </small></td>\n              <td class=\"tabular text-right\"><small>\n                {toFixed(amount, tokenA.decimals)}\n              </small></td>\n              <td class=\"tabular text-right\"><small>\n                {toFixed(price * amount, tokenB.decimals)}\n              </small></td>\n              <td class=\"tabular text-right d-none d-sm-table-cell\"><small>\n                {toFixed(sum += price * amount, tokenB.decimals)}\n              </small></td>\n            </tr>\n          }\n          </tbody>\n        </table>\n      </div>\n    </div>\n  </div>\n","import {abi, networks} from '../../build/contracts/Market'\nimport {net_provider, wallet_provider} from \"./web3\"\n\neth_net_id = localStorage['eth_net_id'] or '1'\neth_net_id = '1' unless networks[eth_net_id]\n\n\nexport Market = window.Market = new Web3EthContract abi, networks[eth_net_id].address\nMarket.setProvider net_provider\n\n\nif wallet_provider\n  Market.Wallet = MarketWallet = new Web3EthContract abi, networks[eth_net_id].address\n  MarketWallet.setProvider wallet_provider\n\n\ngetBlockNumber = new Web3Method\n  name: 'getBlockNumber',\n  call: 'eth_blockNumber',\n  params: 0,\n  outputFormatter: Web3Utils.hexToNumber\n\ngetBlockNumber.setRequestManager Market._requestManager\n\ngetBlockNumber.attachToObject Market\n","import {abi, networks as tokenANetworks} from '../../build/contracts/ERC20MintableA'\nimport {networks as tokenBNetworks} from '../../build/contracts/ERC20MintableB'\nimport WETH9_ABI from './WETH9.abi'\nimport {net_provider, wallet_provider} from \"./web3\"\nimport {WBTC_TOKEN, WETH_TOKEN} from \"../config\"\n\n\neth_net_id = localStorage['eth_net_id'] or '1'\neth_net_id = '1' unless tokenANetworks[eth_net_id]\n\nif eth_net_id is '1'\n  # https://weth.io/\n  token_A_address = WETH_TOKEN\n  token_A_abi = WETH9_ABI\n  # https://www.wbtc.network/\n  token_B_address = WBTC_TOKEN\n  token_B_abi = abi\nelse\n  token_A_address = tokenANetworks[eth_net_id].address\n  token_A_abi = abi\n  token_B_address = tokenBNetworks[eth_net_id].address\n  token_B_abi = abi\n\n\nexport TokenA = window.TokenA = new Web3EthContract token_A_abi, token_A_address\nTokenA.setProvider net_provider\n\n\nexport TokenB = window.TokenB = new Web3EthContract token_B_abi, token_B_address\nTokenB.setProvider net_provider\n\n\nif wallet_provider\n  TokenA.Wallet = TokenAWallet = new Web3EthContract token_A_abi, token_A_address\n  TokenAWallet.setProvider wallet_provider\n\n  TokenB.Wallet = TokenBWallet = new Web3EthContract token_B_abi, token_B_address\n  TokenBWallet.setProvider wallet_provider\n\n","# https://github.com/0xProject/0x-monorepo/blob/0c9daa693/packages/abi-gen-wrappers/src/generated-wrappers/weth9.ts#L1355\n\nexport default [\n  {\n    constant: true,\n    inputs: [],\n    name: 'name',\n    outputs: [\n      {\n        name: '',\n        type: 'string',\n      },\n    ],\n    payable: false,\n    stateMutability: 'view',\n    type: 'function',\n  },\n  {\n    constant: false,\n    inputs: [\n      {\n        name: 'guy',\n        type: 'address',\n      },\n      {\n        name: 'wad',\n        type: 'uint256',\n      },\n    ],\n    name: 'approve',\n    outputs: [\n      {\n        name: '',\n        type: 'bool',\n      },\n    ],\n    payable: false,\n    stateMutability: 'nonpayable',\n    type: 'function',\n  },\n  {\n    constant: true,\n    inputs: [],\n    name: 'totalSupply',\n    outputs: [\n      {\n        name: '',\n        type: 'uint256',\n      },\n    ],\n    payable: false,\n    stateMutability: 'view',\n    type: 'function',\n  },\n  {\n    constant: false,\n    inputs: [\n      {\n        name: 'src',\n        type: 'address',\n      },\n      {\n        name: 'dst',\n        type: 'address',\n      },\n      {\n        name: 'wad',\n        type: 'uint256',\n      },\n    ],\n    name: 'transferFrom',\n    outputs: [\n      {\n        name: '',\n        type: 'bool',\n      },\n    ],\n    payable: false,\n    stateMutability: 'nonpayable',\n    type: 'function',\n  },\n  {\n    constant: false,\n    inputs: [\n      {\n        name: 'wad',\n        type: 'uint256',\n      },\n    ],\n    name: 'withdraw',\n    outputs: [],\n    payable: false,\n    stateMutability: 'nonpayable',\n    type: 'function',\n  },\n  {\n    constant: true,\n    inputs: [],\n    name: 'decimals',\n    outputs: [\n      {\n        name: '',\n        type: 'uint8',\n      },\n    ],\n    payable: false,\n    stateMutability: 'view',\n    type: 'function',\n  },\n  {\n    constant: true,\n    inputs: [\n      {\n        name: 'index_0',\n        type: 'address',\n      },\n    ],\n    name: 'balanceOf',\n    outputs: [\n      {\n        name: '',\n        type: 'uint256',\n      },\n    ],\n    payable: false,\n    stateMutability: 'view',\n    type: 'function',\n  },\n  {\n    constant: true,\n    inputs: [],\n    name: 'symbol',\n    outputs: [\n      {\n        name: '',\n        type: 'string',\n      },\n    ],\n    payable: false,\n    stateMutability: 'view',\n    type: 'function',\n  },\n  {\n    constant: false,\n    inputs: [\n      {\n        name: 'dst',\n        type: 'address',\n      },\n      {\n        name: 'wad',\n        type: 'uint256',\n      },\n    ],\n    name: 'transfer',\n    outputs: [\n      {\n        name: '',\n        type: 'bool',\n      },\n    ],\n    payable: false,\n    stateMutability: 'nonpayable',\n    type: 'function',\n  },\n  {\n    constant: false,\n    inputs: [],\n    name: 'deposit',\n    outputs: [],\n    payable: true,\n    stateMutability: 'payable',\n    type: 'function',\n  },\n  {\n    constant: true,\n    inputs: [\n      {\n        name: 'index_0',\n        type: 'address',\n      },\n      {\n        name: 'index_1',\n        type: 'address',\n      },\n    ],\n    name: 'allowance',\n    outputs: [\n      {\n        name: '',\n        type: 'uint256',\n      },\n    ],\n    payable: false,\n    stateMutability: 'view',\n    type: 'function',\n  },\n  {\n    inputs: [],\n    outputs: [],\n    payable: true,\n    stateMutability: 'payable',\n    type: 'fallback',\n  },\n  {\n    anonymous: false,\n    inputs: [\n      {\n        name: '_owner',\n        type: 'address',\n        indexed: true,\n      },\n      {\n        name: '_spender',\n        type: 'address',\n        indexed: true,\n      },\n      {\n        name: '_value',\n        type: 'uint256',\n        indexed: false,\n      },\n    ],\n    name: 'Approval',\n    outputs: [],\n    type: 'event',\n  },\n  {\n    anonymous: false,\n    inputs: [\n      {\n        name: '_from',\n        type: 'address',\n        indexed: true,\n      },\n      {\n        name: '_to',\n        type: 'address',\n        indexed: true,\n      },\n      {\n        name: '_value',\n        type: 'uint256',\n        indexed: false,\n      },\n    ],\n    name: 'Transfer',\n    outputs: [],\n    type: 'event',\n  },\n  {\n    anonymous: false,\n    inputs: [\n      {\n        name: '_owner',\n        type: 'address',\n        indexed: true,\n      },\n      {\n        name: '_value',\n        type: 'uint256',\n        indexed: false,\n      },\n    ],\n    name: 'Deposit',\n    outputs: [],\n    type: 'event',\n  },\n  {\n    anonymous: false,\n    inputs: [\n      {\n        name: '_owner',\n        type: 'address',\n        indexed: true,\n      },\n      {\n        name: '_value',\n        type: 'uint256',\n        indexed: false,\n      },\n    ],\n    name: 'Withdrawal',\n    outputs: [],\n    type: 'event',\n  },\n]\n","import {toBigString} from '../util'\n\nSWAP_TYPE =\n  '0': 'BUY'\n  '1': 'SELL'\n\nexport default (utils)=>(web3_wallet)=>(Market)=>(TokenA)=>(TokenB)=>\n  {abi, keccak256, toBN} = utils\n  decimalsA = TokenA and TokenA.methods.decimals().call().then (d)=> +d\n  decimalsB = TokenB and TokenB.methods.decimals().call().then (d)=> +d\n\n\n  address: Market and Market._address\n  last_price: 0\n  volume: 0\n\n  on_balance_update: =>\n\n  # TODO persistent storage\n  commits__hash: {}\n  buy_commits: []\n  sell_commits: []\n  clearance_subscription: null\n  eviction_subscription: null\n\n  bids__id: {}\n  bids: []\n  offers__id: {}\n  offers: []\n\n  history: []\n  history__swap_hash: {}\n  history__event_id: {}\n  history_subscription: null\n\n  blocks: {} # TODO get blocks time for history\n\n  inited: false\n  loading_book: true\n  loading_history: true\n\n  _:\n    init: ($, state)=>\n      if not state.inited and Market and Market.getBlockNumber\n        state.inited = true\n        block_number = await new Promise (resolve, reject)=>\n          Market.getBlockNumber (error, result)=>\n            if error\n              reject error\n            else\n              resolve result\n\n        state._.getSwapBook block_number\n        state._.getHistory block_number\n        # TODO do it only after commits are restored from local storage\n        state._.getCommitClearance block_number\n\n\n    destroy: ($, state)=>\n      state.history_subscription?.unsubscribe()\n      state.clearance_subscription?.unsubscribe()\n      state.eviction_subscription?.unsubscribe()\n\n\n    getCommitClearance: (block_number, state)=>\n      clearance_subscription: Market.events.CommitCleared fromBlock: block_number - 11,\n          (error, {returnValues: {hash}})=>\n            if error\n              console.error error\n            else\n              if commit = state.commits__hash[hash]\n                commit.clearing = false\n                commit.cleared = true\n                state._ {}\n            return\n\n      eviction_subscription: Market.events.CommitEvicted fromBlock: block_number - 11,\n          (error, {returnValues: {hash}})=>\n            if error\n              console.error error\n            else\n              if commit = state.commits__hash[hash]\n                commit.clearing = false\n                commit.evicted = true\n                state._ {}\n            return\n\n\n    getHistory: (block_number, state)=>\n      state._ loading_history: true\n      dA = await decimalsA\n      dB = await decimalsB\n\n      events = await Market.getPastEvents 'SwapFilled',\n        filter:\n          Token: TokenA._address\n          quoteToken: TokenB._address\n        fromBlock: block_number - 6000 * 30 # 30 days\n        toBlock: block_number\n\n\n\n      history__swap_hash = {}\n      history__event_id = {}\n      history = []\n\n      unwrap = ({removed, blockHash, transactionHash, logIndex, returnValues: {id, swapType, price, amount, maker, taker}})=>\n        eventId = [blockHash, transactionHash, logIndex].join ''\n        if removed\n          if old_item = history__event_id[eventId]\n            history__swap_hash[id] = history__event_id[eventId] = undefined\n            history.splice history.indexOf(old_item), 1\n        else if !history__event_id[eventId]\n          if web3_wallet.get_address() in [maker, taker]\n            state.on_balance_update?()\n          history.unshift history__swap_hash[id] = history__event_id[eventId] = {\n            swapType: SWAP_TYPE[swapType]\n            price: parseFloat(price) / 10 ** dB\n            amount: parseFloat(amount) / 10 ** dA\n            id\n            eventId\n            blockHash\n            maker\n            taker\n          }\n        return\n\n      events.forEach unwrap\n\n\n      state._ {\n        loading_history: false\n        history\n        history__swap_hash\n        history__event_id\n        history_subscription: Market.events.SwapFilled fromBlock: block_number + 1,\n          (error, event)=>\n            if error\n              console.error error\n            else\n              unwrap event\n              state._ {}\n      }\n\n\n    getSwapBook: (block_number, state)=>\n      state._ loading_book: true\n      dA = await decimalsA\n      dB = await decimalsB\n\n      bids__id = {}\n      offers__id = {}\n      bids = []\n      offers = []\n\n      fill__event_id = {}\n\n      # TODO retrieve my commits that far from 200 in book, or save them in Gaia storage\n\n      # TODO use cloudflare for calls and infura for subs\n      await Promise.all [\n        Market.methods\n        .getSwapBook(\n          TokenA._address\n          TokenB._address\n          0\n          200\n          '0x0'\n        )\n        .call undefined, block_number\n        .then (swaps)=>\n          state._\n            bids__id: bids__id\n            bids: bids = swaps.map (swap)=>\n              {id, price, amount} = swap\n              swap.price = parseFloat(price) / 10 ** dB\n              swap.amount = parseFloat(amount) / 10 ** dA\n              bids__id[id] = swap\n      ,\n        Market.methods\n        .getSwapBook(\n          TokenA._address\n          TokenB._address\n          1\n          200\n          '0x0'\n        )\n        .call undefined, block_number\n        .then (swaps)=>\n          state._\n            offers__id: offers__id\n            offers: offers = swaps.map (swap)=>\n              {id, price, amount} = swap\n              swap.price = parseFloat(price) / 10 ** dB\n              swap.amount = parseFloat(amount) / 10 ** dA\n              offers__id[id] = swap\n      ]\n\n      state._ {\n        loading_book: false\n        placed_subscription: Market.events.SwapPlaced\n          filter: BaseToken: TokenA._address, QuoteToken: TokenB._address\n          fromBlock: block_number + 1\n        , (error, {removed, returnValues: {id, swapType, wallet, amount, price, placedAfter}})=>\n            if error\n              console.error error\n            else\n              # TODO removed\n              swaps__id = if +swapType is 0 then bids__id else offers__id\n              swaps = if +swapType is 0 then bids else offers\n\n              return if swaps__id[id]\n\n              if placedAfter is '0x0000000000000000000000000000000000000000000000000000000000000000'\n                swap = {id, swapType, wallet}\n                swap.price = parseFloat(price) / 10 ** dB\n                swap.amount = parseFloat(amount) / 10 ** dA\n                swaps__id[id] = swap\n                swaps.unshift swap\n                state._ {}\n              else if placeAfter = swaps__id[placedAfter]\n                swap = {id, swapType, wallet}\n                swap.price = parseFloat(price) / 10 ** dB\n                swap.amount = parseFloat(amount) / 10 ** dA\n                swaps__id[id] = swap\n                index = swaps.indexOf placeAfter\n                swaps.splice index + 1, 0, swap\n                state._ {}\n            return\n\n        filled_subscription: Market.events.SwapFilled\n          filter: BaseToken: TokenA._address, QuoteToken: TokenB._address\n          fromBlock: block_number + 1\n        , (error, {removed, blockHash, transactionHash, logIndex, returnValues: {id, swapType, amount, fully}})=>\n            eventId = [blockHash, transactionHash, logIndex].join ''\n            if error\n              console.error error\n            else unless fill__event_id[eventId]\n              fill__event_id[eventId] = true\n\n              # TODO removed\n              swaps__id = if +swapType is 1 then bids__id else offers__id\n              swaps = if +swapType is 1 then bids else offers\n\n              if swap = swaps__id[id]\n                if fully # fully filled\n                  index = swaps.indexOf swap\n                  swaps.splice index, 1\n                  swaps__id[id] = undefined\n                else\n                  swap.amount -= parseFloat(amount) / 10 ** dA\n                state._ {}\n            return\n\n        canceled_subscription: Market.events.SwapCanceled\n          filter: BaseToken: TokenA._address, QuoteToken: TokenB._address\n          fromBlock: block_number + 1\n        , (error, {removed, returnValues: {id, swapType,}})=>\n            if error\n              console.error error\n            else\n              # TODO removed\n              swaps__id = if +swapType is 0 then bids__id else offers__id\n              swaps = if +swapType is 0 then bids else offers\n\n              if swap = swaps__id[id]\n                index = swaps.indexOf swap\n                swaps.splice index, 1\n                swaps__id[id] = undefined\n                state._ {}\n            return\n      }\n\n\n    limitBuy: ({token, quoteToken, amount, price}, state)=>\n      commit = {\n        wallet: web3_wallet.get_address(),\n        token, quoteToken,\n        swapType: 0, # BUY\n        amountString: toBigString(amount * 10 ** await decimalsA),\n        priceString: toBigString(price * 10 ** await decimalsB),\n        nonce: Date.now()\n      }\n\n      hash = keccak256 abi.encodeParameters [\n        'address', 'address', 'address',\n        'uint256', 'uint256', 'uint256', 'uint256'\n      ], Object.values commit\n\n      commit.hash = hash\n      commit.amount = amount\n      commit.price = price\n\n      state.buy_commits.push state.commits__hash[hash] = commit\n      state._ {} # trigger update\n      state._.commitSwap commit\n        .then ({blockHash})=>\n          commit.blockHash = blockHash\n          state._ {}\n        .catch (e)=>\n          state.buy_commits.splice state.buy_commits.indexOf(commit), 1\n          state._ {}\n          Promise.reject e\n\n\n\n    limitSell: ({token, quoteToken, amount, price}, state)=>\n      commit = {\n        wallet: web3_wallet.get_address(),\n        token, quoteToken,\n        swapType: 1, # SELL\n        amountString: toBigString(amount * 10 ** await decimalsA),\n        priceString: toBigString(price * 10 ** await decimalsB),\n        nonce: Date.now()\n      }\n\n      hash = keccak256 abi.encodeParameters [\n        'address', 'address', 'address',\n        'uint256', 'uint256', 'uint256', 'uint256'\n      ], Object.values commit\n\n      commit.hash = hash\n      commit.amount = amount\n      commit.price = price\n\n      state.sell_commits.push state.commits__hash[hash] = commit\n      state._ {} # trigger update\n      state._.commitSwap commit\n        .then ({blockHash})=>\n          commit.blockHash = blockHash\n          state._ {}\n        .catch (e)=>\n          state.sell_commits.splice state.sell_commits.indexOf(commit), 1\n          state._ {}\n          Promise.reject e\n\n\n    commitSwap: (commit)=>\n      return unless Market.Wallet\n      Market.Wallet.methods\n        .commitSwap commit.token, commit.quoteToken, commit.hash\n        .send from: web3_wallet.get_address()\n        .then (commit)=>\n          console.log {commit}\n          commit\n\n\n    reveal: (commit)=>($, state)=>\n      return unless Market.Wallet\n      [wallet, token, quoteToken, swapType,\n        amount, price, nonce] = Object.values commit\n\n      commit.revealing = true\n\n      Market.Wallet.methods\n        .reveal(commit.blockHash, token, quoteToken, swapType.toString(),\n          amount, price, nonce)\n        .send from: web3_wallet.get_address(), gas: 400000\n        .then (reveal)=>\n          console.log {reveal}\n          commit.revealing = false\n          commit.revealed = true\n          commit.clearing = true\n          state._ {}\n          reveal\n        .catch =>\n          commit.revealing = false\n          state._ {}\n\n      state._ {}\n      return\n\n\n    execute: ($, state)=>\n      return unless Market.Wallet\n      Market.Wallet.methods\n        .executeSwaps TokenA._address, TokenB._address\n        .send from: web3_wallet.get_address(), gas: 400000\n        .then (executed)=>\n          console.log {executed}\n          executed\n        .catch (e)=>\n          console.error e\n          Promise.reject e\n\n\n    cancel_bid: (bid, state)=>\n      return unless Market.Wallet\n      bid.canceling = true\n      state._ {}\n      Market.Wallet.methods\n        .cancelBuySwap TokenA._address, TokenB._address, bid.id, '0x0'\n        .send from: web3_wallet.get_address()\n        .then (canceled)=>\n          console.log {canceled}\n          canceled\n        .catch (e)=>\n          console.error e\n          bid.canceling = false\n          state._ {}\n          Promise.reject e\n\n\n    cancel_offer: (offer, state)=>\n      return unless Market.Wallet\n      offer.canceling = true\n      state._ {}\n      Market.Wallet.methods\n        .cancelSellSwap TokenA._address, TokenB._address, offer.id, '0x0'\n        .send from: web3_wallet.get_address()\n        .then (canceled)=>\n          console.log {canceled}\n          canceled\n        .catch (e)=>\n          console.error e\n          offer.canceling = false\n          state._ {}\n          Promise.reject e\n","import {WBTC_TOKEN, WETH_TOKEN} from \"../config\"\nimport {toBigString} from '../util'\n\nexport default (web3_wallet)=>(ERC20)=>(market)=>\n  decimals = ERC20 and ERC20.methods.decimals().call().then (d)=> +d\n\n  address: ERC20 and ERC20._address\n  name: ''\n  symbol: ''\n  decimals: 0\n  balance: 0\n  allowance: 0\n\n  inited: false\n  loading: true\n  minting: false\n  approving: false\n  canceling: false\n  wrapping: false\n  unwrapping: false\n\n  _:\n    init: ($, state)=>\n      if not state.inited\n        state.inited = true\n        ERC20.methods.name().call().then (name)=> state._ {name}\n        ERC20.methods.symbol().call().then (symbol)=> state._ {symbol}\n        decimals.then (decimals)=> state._ {decimals}\n\n        if web3_wallet.get_address()\n          state._.getBalance()\n          state._.getAllowance()\n          addEventListener 'focus', state._.getBalance\n        else\n          decimals.then => state._ loading: false\n\n\n    getBalance: ($, {_})=>\n      _ loading: true\n      d = await decimals\n      ERC20.methods\n        .balanceOf web3_wallet.get_address()\n        .call()\n        .then (balance)=>\n          _ loading: false, balance: parseFloat(balance) / (10 ** d)\n\n\n    mint: (amount)=>($, {_})=>\n      return unless ERC20.Wallet\n      _ minting: true\n      d = await decimals\n      await ERC20.Wallet.methods\n        .mint web3_wallet.get_address(), toBigString amount * 10 ** d\n        .send from: web3_wallet.get_address()\n        .finally => _ minting: false\n      _.getBalance()\n\n\n    getAllowance: ($, state)=>\n      state.allowance ?= 0\n      d = await decimals\n      ERC20.methods\n        .allowance(web3_wallet.get_address(), market)\n        .call()\n        .then (allowance)=>\n            state._ allowance: parseFloat(allowance) / (10 ** d)\n\n\n    approve: (amount)=>($, {_})=>\n      return unless ERC20.Wallet\n      _ approving: true\n      d = await decimals\n      await ERC20.Wallet.methods\n        .approve market, toBigString amount * 10 ** d\n        .send from: web3_wallet.get_address()\n        .finally => _ approving: false\n      _.getAllowance()\n\n\n    wrap: ($, {address, _})=>\n      return unless ERC20.Wallet and address is WETH_TOKEN\n      _ wrapping: true\n      balance = parseFloat await web3_wallet.get_balance web3_wallet.get_address()\n\n      await ERC20.Wallet.methods\n        .deposit()\n        .send\n            from: web3_wallet.get_address()\n            value: toBigString 0.8 * balance\n        .finally => _ wrapping: false\n      _.getBalance()\n\n\n    unwrap: ($, {address, balance, _})=>\n      return unless ERC20.Wallet and address is WETH_TOKEN\n      _ unwrapping: true\n\n      d = await decimals\n\n      await ERC20.Wallet.methods\n        .withdraw toBigString balance * 10 ** d\n        .send from: web3_wallet.get_address()\n        .finally => _ unwrapping: false\n      _.getBalance()\n\n","import {app, mount} from '@playframe/playframe'\nimport View from './View'\nimport web3_wallet from './data/web3'\nimport {Market} from './data/Market'\nimport {TokenA, TokenB} from './data/TokenPair'\n\nimport rainbow from './state/rainbow'\nimport account from './state/account'\nimport token from './state/token'\nimport market from './state/market'\nimport form from './state/form'\n\n\nweb3utils = {Web3Utils..., abi: Web3Abi}\n\n\nstate = app(\n  show_intro: not localStorage['hide_intro']\n  rainbow: rainbow(),\n  web3_wallet: web3_wallet\n  account: account()\n  market: market(web3utils)(web3_wallet)(Market)(TokenA)(TokenB)\n  tokenA: token(web3_wallet)(TokenA)(Market and Market._address)\n  tokenB: token(web3_wallet)(TokenB)(Market and Market._address)\n  buy_form: form()\n  sell_form: form()\n)(\n  View\n)(\n  mount document.body\n)\n\n","export default =>\n  colors: colors = [\n    [35, 51, 51]\n    [35, 51, 47]\n    [36, 51, 35]\n    [35, 51, 49]\n    [40, 51, 35]\n    [40, 51, 38]\n  ]\n  those: [0, 1, 0, 3]\n  stage: 0\n  speed: 0.01\n\n  inited: false\n  active: true\n\n  _:\n    init: ($, state)=>\n      unless state.inited\n        state.inited = true\n        state._.calc()\n\n    destroy: ($, state)=>\n      state.active = false\n\n    calc: ($, state)=>\n      return unless state.active\n\n      if window.requestIdleCallback\n        setTimeout (=>\n          requestIdleCallback state._.calc), 100\n      else\n        setTimeout state._.calc, 1000\n\n      {random, round} = Math\n      {colors, those, stage, speed} = state\n\n      state.style = backgroundImage: \"linear-gradient(to left,\n      rgb(#{\n        round colors[those[0]][0] * (1 - stage) + colors[those[1]][0] * stage\n      }, #{\n        round colors[those[0]][1] * (1 - stage) + colors[those[1]][1] * stage\n      }, #{\n        round colors[those[0]][2] * (1 - stage) + colors[those[1]][2] * stage\n      }) , rgb(#{\n        round colors[those[2]][0] * (1 - stage) + colors[those[3]][0] * stage\n      }, #{\n        round colors[those[2]][1] * (1 - stage) + colors[those[3]][1] * stage\n      }, #{\n        round colors[those[2]][2] * (1 - stage) + colors[those[3]][2] * stage\n      }))\"\n\n      if (state.stage += speed) >= 1\n        state.stage -= 1\n        those[0] = those[1]\n        those[2] = those[3]\n        those[1] = (random() * colors.length) | 0\n        those[3] = (random() * colors.length) | 0\n\n      return\n\n","import {toFixed} from '../util'\n\nexport default ()=>\n  values: {}\n  updates: {}\n\n  _:\n    readNumberAndAdjust: (field)=>(adjust)=>(decimals)=>({target}, state)=>\n      {values} = state\n      if value = values[field] = target.value and parseFloat target.value\n        if (field is 'price limit' and adjust is 'total' and values.amount) or\n            (field is 'amount' and adjust is 'total' and values['price limit'])\n          state.updates.total = values['price limit'] * values.amount\n          state._ {} # trigger render\n        else if field is 'total' and adjust is 'amount' and values['price limit']\n          state.updates.amount = values.total / values['price limit']\n          state._ {}\n      return\n\n\n    updateInputValue: (field)=>(decimals)=>(target, state)=>\n      if (update = state.updates[field])?\n        target.value = toFixed state.values[field] = update, decimals\n        # silent mutation, don't trigger rerender\n        state._().updates = `{\n          ...state.updates,\n          [field]: undefined\n        }`\n      return\n","export default =>\n  userSession: null\n  isSignedIn: false\n  name: ''\n  username: ''\n\n  inited: false\n\n  _:\n    init: ($, state)=>\n      unless state.inited\n        state.inited = true\n        if window.blockstack\n          state._.init_blockstack()\n        else\n          addEventListener 'load', state._.init_blockstack\n\n\n    init_blockstack: ($, state)=>\n      userSession = state._.setUserSession()\n      if userSession.isUserSignedIn()\n        state._.setUserData userSession.loadUserData()\n      else if userSession.isSignInPending()\n        userSession.handlePendingSignIn()\n          .then (userData)=>\n            if location.search\n              window.location = location.origin\n            else\n              state._.setUserData userData\n      return\n\n\n    setUserSession: ($, state)=>\n      appConfig = new blockstack.AppConfig\n      state.userSession = new blockstack.UserSession appConfig: appConfig\n\n\n    setUserData: (userData, state)=>\n      state.userData = userData\n      state.person = person = new blockstack.Person userData.profile\n      state.isSignedIn = state.userSession.isUserSignedIn()\n      state.name = person and person.name() or userData and\n        userData.username.replace '.id.blockstack', ''\n      state.username = userData and userData.username\n\n\n    signin: ($, state)=>\n      state.userSession.redirectToSignIn()\n\n    signout: ($, state)=>\n      state.userSession.signUserOut()\n      window.location = window.location.origin\n"],"names":["delta","pusher","runner","scheduler","next","f","_scheduled","g","x","task","ops","op","push","now","_prev_ts","ts","e","i","length","recover","error","console","r","assign","create","is_function","keys","statue","hasProp","hasOwnProperty","Object","VNODE","_registry","h","invoke","state_actions","delayed","level_up","_nested","_state","action","actions","delay_nested","inject_state","k","reset","save_state","schedule","update_parent","update_state","v","_","sub_state","state","proto_state","arg","cloned","mutated","y","call","then","Symbol","ELEMENT","EVENTS","KEYED","_first_run","_sync","doc","emmit_remove","eventHandler","get_key","isArray","make_el","mutate_children","mutate_dom","patcher","remove_el","scan","set","set_attr","a","component","name","use","components","Component","props","children","child","flat","len","Array","require$$0","document","event","currentTarget","type","el","NS","childNodes","m","ref","shadow","v_dom","namespaceURI","nodeType","nodeValue","nodeName","toLowerCase","shadowRoot","patch","parent","vnode","old_vnode","new_el","onupdate","xmlns","insertBefore","by_key","child_el","el_i","j","key","keyed","l","ll","old_child","old_key","old_keyed","replaced_el","replacement","sub_child","sub_i","sub_il","sub_j","sub_jl","render","oncreate","shadow_props","createElementNS","createElement","attachShadow","createTextNode","removeChild","onremove","attr","old_attr","old_v","value","old_value","events","style","cssText","charCodeAt","setProperty","slice","addEventListener","removeEventListener","setAttribute","removeAttribute","_old_vnode","LEAF","NAMED","WILDCARD","_404","_Page","_fallback","_href","_props","_subscribed","add_methods","forest","get_trie","grow_trie","make_trie","match","set_Page","subscribe","walk_trie","this","WeakMap","sync","href","location","hop","frame","scrollTo","history","replaceState","height","body","clientHeight","pushState","replace","ontouchstart","composedPath","target","parentNode","button","metaKey","altKey","ctrlKey","shiftKey","origin","getAttribute","startsWith","preventDefault","minHeight","setTimeout","hash","pair","pathname","query","search","split","routes","trie","get","path","param","position","fallback","Page","named","step","sub_trie","pos","route","first_char","named_trie","wild","root","_dom","_new_v_dom","_v_dom","view","require$$2","steps","delta_runner","push_and_run","step_ops","steps_ops","map","run","forEach","Date","requestAnimationFrame","require$$3","require$$4","TokenInput","_debounce_id","debounce","stop_bounce","container","finally","require$$6","DOMAIN","WBTC_TOKEN","WETH_TOKEN","toFixed","number","decimals","Math","min","isNaN","toBigString","toLocaleString","useGrouping","maximumFractionDigits","time","fn","args","clearTimeout","form","token","field","adjust","prefix","class","for","inputmode","id","placeholder","required","pattern","title","autocomplete","onchange","readNumberAndAdjust","onkeyup","updateInputValue","symbol","_address","check_network","ref1","reload","web3_instance","account","market","rainbow","tokenA","tokenB","init","on_balance_update","getBalance","getAllowance","documentElement","show_intro","show_menu","web3_wallet","fontWeight","cursor","onclick","localStorage","src","width","address","isSignedIn","get_address","window","ethereum","isMetaMask","enable","username","signout","userSession","signin","NavBar","role","Intro","loading","balance","allowance","disabled","minting","mint","approving","approve","wrapping","wrap","unwrapping","unwrap","Tokens","buy_form","sell_form","onsubmit","limitBuy","quoteToken","amount","values","price","total","buy_commits","order","blockHash","cleared","clearing","evicted","revealed","revealing","opacity","flex","reveal","limitSell","sell_commits","Forms","my_bids_only","my_offers_only","bids","my_bids","my_offers","offers","sum","filter","wallet","checked","loading_book","colSpan","bid","canceling","cancel_bid","offer","cancel_offer","Book","my_history_only","my_history","maker","taker","loading_history","swapType","History","autoRefreshOnNetworkChange","on","net","accounts","Web3","web3","currentProvider","networkVersion","selectedAddress","info","getNetwork","err","net_id","MarketWallet","eth_net_id","getBlockNumber","ref2","defaultAccount","get_balance","Promise","resolve","reject","eth","data","net_provider","Web3ProviderWS","wallet_provider","networks","Market","Web3EthContract","abi","setProvider","Wallet","Web3Method","params","outputFormatter","Web3Utils","hexToNumber","setRequestManager","_requestManager","attachToObject","TokenAWallet","TokenBWallet","token_A_abi","token_A_address","token_B_abi","token_B_address","tokenANetworks","constant","inputs","outputs","payable","stateMutability","anonymous","indexed","TokenA","TokenB","SWAP_TYPE","ERC20","methods","d","inited","$","async","balanceOf","parseFloat","send","from","deposit","withdraw","0","1","web3utils","colors","updates","update","Web3Abi","app","those","stage","speed","active","calc","destroy","random","round","requestIdleCallback","backgroundImage","blockstack","init_blockstack","setUserSession","isUserSignedIn","setUserData","loadUserData","isSignInPending","handlePendingSignIn","userData","appConfig","AppConfig","UserSession","person","Person","profile","redirectToSignIn","signUserOut","utils","decimalsA","decimalsB","keccak256","toBN","last_price","volume","commits__hash","clearance_subscription","eviction_subscription","bids__id","offers__id","history__swap_hash","history__event_id","history_subscription","blocks","block_number","result","getSwapBook","getHistory","getCommitClearance","unsubscribe","CommitCleared","fromBlock","returnValues","commit","CommitEvicted","dA","dB","getPastEvents","Token","toBlock","removed","transactionHash","logIndex","eventId","old_item","join","splice","indexOf","unshift","SwapFilled","fill__event_id","all","swaps","swap","placed_subscription","SwapPlaced","BaseToken","QuoteToken","placedAfter","index","placeAfter","swaps__id","filled_subscription","fully","canceled_subscription","SwapCanceled","amountString","priceString","nonce","encodeParameters","commitSwap","catch","log","toString","gas","execute","executeSwaps","executed","cancelBuySwap","canceled","cancelSellSwap","View","mount"],"mappings":"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"}